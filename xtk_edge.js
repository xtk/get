/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/closure-library/LICENSE
 * 
 *  - the JSXCompressor library (http://jsxgraph.uni-bayreuth.de/wp/jsxcompressor/)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/JXG/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function i(a){throw a;}var k=void 0,n=!0,q=null,r=!1;function ba(){return function(){}}function ca(a){return function(b){this[a]=b}}function s(a){return function(){return this[a]}}var u,ea=this;function fa(){}
function ga(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ha(a){return a!==k}function x(a){return a!=q}function ia(a){return"array"==ga(a)}function ja(a){var b=ga(a);return"array"==b||"object"==b&&"number"==typeof a.length}function la(a){return"string"==typeof a}function y(a){return"number"==typeof a}function ma(a){return"function"==ga(a)}function na(a){a=ga(a);return"object"==a||"array"==a||"function"==a}function oa(a){return a[ra]||(a[ra]=++sa)}
var ra="closure_uid_"+Math.floor(2147483648*Math.random()).toString(36),sa=0;function ta(a,b,c){return a.call.apply(a.bind,arguments)}function va(a,b,c){a||i(Error());if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function wa(a,b,c){wa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:va;return wa.apply(q,arguments)}function xa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var ya=Date.now||function(){return+new Date};
function B(a,b){var c=a.split("."),d=ea;!(c[0]in d)&&d.execScript&&d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)!c.length&&ha(b)?d[e]=b:d=d[e]?d[e]:d[e]={}}function D(a,b){function c(){}c.prototype=b.prototype;a.h=b.prototype;a.prototype=new c;a.prototype.constructor=a};function za(a,b,c){this.ra=this.qa=this.pa=0;3==arguments.length?(this.pa=Number(a),this.qa=Number(b),this.ra=Number(c)):a instanceof za?(this.pa=Number(a.x()),this.qa=Number(a.y()),this.ra=Number(a.b())):(this.pa=Number(a[0]),this.qa=Number(a[1]),this.ra=Number(a[2]))}
za.prototype={f:function(){return new za(this.pa,this.qa,this.ra)},Fe:function(){return new za(-this.pa,-this.qa,-this.ra)},ic:function(a){return new za(this.pa+a.x(),this.qa+a.y(),this.ra+a.b())},Pc:function(a){return new za(this.pa-a.x(),this.qa-a.y(),this.ra-a.b())},ub:function(a){return new za(this.pa*a,this.qa*a,this.ra*a)},Kg:function(a){return new za(this.pa/a,this.qa/a,this.ra/a)},fc:function(a){return this.pa*a.x()+this.qa*a.y()+this.ra*a.b()},Kf:function(a,b){return this.ic(a.Pc(this).ub(b))},
length:function(){return Math.sqrt(this.fc(this))},Vc:function(){return this.Kg(this.length())},ne:function(a){return new za(this.qa*a.b()-this.ra*a.y(),this.ra*a.x()-this.pa*a.b(),this.pa*a.y()-this.qa*a.x())},x:s("pa"),y:s("qa"),b:s("ra")};var G=G||{};G.ui=n;G.sa=function(a){eval("X.DEV === undefined")||window.console.time(a)};G.ga=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.vg=0;this.qi=function(){return this.vg++}};function Ca(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c]}}
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,e.concat(d.call(arguments)))}function c(){}"function"!==typeof this&&i(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var d=Array.prototype.slice,e=d.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
(function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.Rc;++c)window.Rc=window[b[c]+"RequestAnimationFrame"],window.ie=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.Rc||(window.Rc=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.ie||(window.ie=function(a){clearTimeout(a)})})();B("Function.prototype.bind",Function.prototype.bind);B("window.requestAnimationFrame",window.Rc);
B("window.cancelAnimationFrame",window.ie);function Da(a){if(!Ea.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Fa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ha,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ia,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ja,"&quot;"));return a}var Fa=/&/g,Ha=/</g,Ia=/>/g,Ja=/\"/g,Ea=/[&<>\"]/;var Ka,La,Ma,Na,Oa,Pa,Qa;function Sa(){return ea.navigator?ea.navigator.userAgent:q}function Ta(){return ea.navigator}Oa=Na=Ma=La=Ka=r;var Ua;if(Ua=Sa()){var Va=Ta();Ka=0==Ua.indexOf("Opera");La=!Ka&&-1!=Ua.indexOf("MSIE");Na=(Ma=!Ka&&-1!=Ua.indexOf("WebKit"))&&-1!=Ua.indexOf("Mobile");Oa=!Ka&&!Ma&&"Gecko"==Va.product}var Wa=Ka,H=La,Xa=Oa,Ya=Ma,Za=Na,$a,bb=Ta();$a=bb&&bb.platform||"";Pa=-1!=$a.indexOf("Mac");Qa=-1!=$a.indexOf("Win");var cb=!!Ta()&&-1!=(Ta().appVersion||"").indexOf("X11"),db;
a:{var eb="",fb;if(Wa&&ea.opera)var gb=ea.opera.version,eb="function"==typeof gb?gb():gb;else if(Xa?fb=/rv\:([^\);]+)(\)|;)/:H?fb=/MSIE\s+([^\);]+)(\)|;)/:Ya&&(fb=/WebKit\/(\S+)/),fb)var hb=fb.exec(Sa()),eb=hb?hb[1]:"";if(H){var kb,lb=ea.document;kb=lb?lb.documentMode:k;if(kb>parseFloat(eb)){db=""+kb;break a}}db=eb}var mb={};
function nb(a){var b;if(!(b=mb[a])){b=0;for(var c=(""+db).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=(""+a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",h=d[f]||"",j=RegExp("(\\d*)(\\D*)","g"),l=RegExp("(\\d*)(\\D*)","g");do{var m=j.exec(g)||["","",""],p=l.exec(h)||["","",""];if(0==m[0].length&&0==p[0].length)break;b=((0==m[1].length?0:parseInt(m[1],10))<(0==p[1].length?0:parseInt(p[1],10))?-1:(0==m[1].length?0:parseInt(m[1],
10))>(0==p[1].length?0:parseInt(p[1],10))?1:0)||((0==m[2].length)<(0==p[2].length)?-1:(0==m[2].length)>(0==p[2].length)?1:0)||(m[2]<p[2]?-1:m[2]>p[2]?1:0)}while(0==b)}b=mb[a]=0<=b}return b}var ob={};function qb(a){return ob[a]||(ob[a]=H&&document.documentMode&&document.documentMode>=a)};function rb(a,b){for(var c in a)b.call(k,a[c],c,a)}function sb(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function tb(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}var ub="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",");function vb(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<ub.length;f++)c=ub[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};var wb=Array.prototype,xb=wb.indexOf?function(a,b,c){return wb.indexOf.call(a,b,c)}:function(a,b,c){c=c==q?0:0>c?Math.max(0,a.length+c):c;if(la(a))return!la(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},yb=wb.forEach?function(a,b,c){wb.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},zb=wb.map?function(a,b,c){return wb.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=
la(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ab=wb.some?function(a,b,c){return wb.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return n;return r},Bb=wb.every?function(a,b,c){return wb.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=la(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return r;return n};function Cb(a,b){var c=xb(a,b);0<=c&&wb.splice.call(a,c,1)}
function Gb(a){return wb.concat.apply(wb,arguments)}function Hb(a){if(ia(a))return Gb(a);for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}function Ib(a,b,c){return 2>=arguments.length?wb.slice.call(a,b):wb.slice.call(a,b,c)};function Jb(a){if("function"==typeof a.la)a=a.la();else if(ja(a)||la(a))a=a.length;else{var b=0,c;for(c in a)b++;a=b}return a}function Kb(a){if("function"==typeof a.Sb)return a.Sb();if(la(a))return a.split("");if(ja(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return sb(a)}
function Lb(a,b){if("function"==typeof a.every)return a.every(b,k);if(ja(a)||la(a))return Bb(a,b,k);var c;if("function"==typeof a.Lc)c=a.Lc();else if("function"!=typeof a.Sb)if(ja(a)||la(a)){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else c=tb(a);else c=k;for(var d=Kb(a),e=d.length,f=0;f<e;f++)if(!b.call(k,d[f],c&&c[f],a))return r;return n};var Mb="StopIteration"in ea?ea.StopIteration:Error("StopIteration");function Nb(){}Nb.prototype.next=function(){i(Mb)};Nb.prototype.nc=function(){return this};function Ob(a){if(a instanceof Nb)return a;if("function"==typeof a.nc)return a.nc(r);if(ja(a)){var b=0,c=new Nb;c.next=function(){for(;;){b>=a.length&&i(Mb);if(b in a)return a[b++];b++}};return c}i(Error("Not implemented"))}
function Pb(a,b){if(ja(a))try{yb(a,b,k)}catch(c){c!==Mb&&i(c)}else{a=Ob(a);try{for(;;)b.call(k,a.next(),k,a)}catch(d){d!==Mb&&i(d)}}};function Qb(a,b){this.w={};this.s=[];var c=arguments.length;if(1<c){c%2&&i(Error("Uneven number of arguments"));for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.ge(a)}u=Qb.prototype;u.F=0;u.Wc=0;u.la=s("F");u.Sb=function(){Rb(this);for(var a=[],b=0;b<this.s.length;b++)a.push(this.w[this.s[b]]);return a};u.Lc=function(){Rb(this);return this.s.concat()};u.le=function(a){for(var b=0;b<this.s.length;b++){var c=this.s[b];if(Sb(this.w,c)&&this.w[c]==a)return n}return r};
u.Hc=function(a,b){if(this===a)return n;if(this.F!=a.la())return r;var c=b||Tb;Rb(this);for(var d,e=0;d=this.s[e];e++)if(!c(this.get(d),a.get(d)))return r;return n};function Tb(a,b){return a===b}u.clear=function(){this.w={};this.Wc=this.F=this.s.length=0};u.remove=function(a){return Sb(this.w,a)?(delete this.w[a],this.F--,this.Wc++,this.s.length>2*this.F&&Rb(this),n):r};
function Rb(a){if(a.F!=a.s.length){for(var b=0,c=0;b<a.s.length;){var d=a.s[b];Sb(a.w,d)&&(a.s[c++]=d);b++}a.s.length=c}if(a.F!=a.s.length){for(var e={},c=b=0;b<a.s.length;)d=a.s[b],Sb(e,d)||(a.s[c++]=d,e[d]=1),b++;a.s.length=c}}u.get=function(a,b){return Sb(this.w,a)?this.w[a]:b};u.set=function(a,b){Sb(this.w,a)||(this.F++,this.s.push(a),this.Wc++);this.w[a]=b};u.ge=function(a){var b;a instanceof Qb?(b=a.Lc(),a=a.Sb()):(b=tb(a),a=sb(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};u.f=function(){return new Qb(this)};
u.nc=function(a){Rb(this);var b=0,c=this.s,d=this.w,e=this.Wc,f=this,g=new Nb;g.next=function(){for(;;){e!=f.Wc&&i(Error("The map has changed since the iterator was created"));b>=c.length&&i(Mb);var g=c[b++];return a?g:d[g]}};return g};function Sb(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Ub(a){this.w=new Qb;a&&this.ge(a)}function Vb(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+oa(a):b.substr(0,1)+a}u=Ub.prototype;u.la=function(){return this.w.la()};u.add=function(a){this.w.set(Vb(a),a)};u.ge=function(a){for(var a=Kb(a),b=a.length,c=0;c<b;c++)this.add(a[c])};u.Hd=function(a){for(var a=Kb(a),b=a.length,c=0;c<b;c++)this.remove(a[c])};u.remove=function(a){return this.w.remove(Vb(a))};u.clear=function(){this.w.clear()};
u.contains=function(a){a=Vb(a);return Sb(this.w.w,a)};u.If=function(a){for(var b=new Ub,a=Kb(a),c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};u.Sb=function(){return this.w.Sb()};u.f=function(){return new Ub(this)};u.Hc=function(a){return this.la()==Jb(a)&&Wb(this,a)};
function Wb(a,b){var c=Jb(b);if(a.la()>c)return r;!(b instanceof Ub)&&5<c&&(b=new Ub(b));return Lb(a,function(a){if("function"==typeof b.contains)a=b.contains(a);else if("function"==typeof b.le)a=b.le(a);else if(ja(b)||la(b))a=0<=xb(b,a);else a:{for(var c in b)if(b[c]==a){a=n;break a}a=r}return a})}u.nc=function(){return this.w.nc(r)};function Xb(){}Xb.prototype.wf=r;Xb.prototype.Da=function(){this.wf||(this.wf=n,this.G())};Xb.prototype.G=function(){this.Hg&&Yb.apply(q,this.Hg)};function Zb(a){a&&"function"==typeof a.Da&&a.Da()}function Yb(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];ja(d)?Yb.apply(q,d):Zb(d)}};function $b(a,b){this.Mf=b;this.Kc=[];a>this.Mf&&i(Error("[goog.structs.SimplePool] Initial cannot be greater than max"));for(var c=0;c<a;c++)this.Kc.push(this.td())}D($b,Xb);u=$b.prototype;u.tf=q;u.vf=q;function ac(a,b){a.Kc.length<a.Mf?a.Kc.push(b):a.qe(b)}u.td=function(){return this.tf?this.tf():{}};u.qe=function(a){if(this.vf)this.vf(a);else if(na(a))if(ma(a.Da))a.Da();else for(var b in a)delete a[b]};u.G=function(){$b.h.G.call(this);for(var a=this.Kc;a.length;)this.qe(a.pop());delete this.Kc};function bc(){this.Ic=[];this.Me=new Qb;this.hg=this.ig=this.jg=this.eg=0;this.Uc=new Qb;this.qf=this.gg=0;this.Ge=1;this.re=new $b(0,4E3);this.re.td=function(){return new cc};this.fg=new $b(0,50);this.fg.td=function(){return new dc};var a=this;this.ve=new $b(0,2E3);this.ve.td=function(){return""+a.Ge++};this.ve.qe=ba()}function dc(){this.Ye=this.time=this.count=0}
dc.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");this.Ye&&a.push(" [VarAlloc = ",this.Ye,"]");return a.join("")};function cc(){}function ec(a,b,c,d){var e=[];-1==c?e.push("    "):e.push(fc(a.xf-c));e.push(" ",gc(a.xf-b));0==a.se?e.push(" Start        "):1==a.se?(e.push(" Done "),e.push(fc(a.kj-a.startTime)," ms ")):e.push(" Comment      ");e.push(d,a);0<a.mi&&e.push("[VarAlloc ",a.mi,"] ");return e.join("")}
cc.prototype.toString=function(){return this.type==q?this.Eg:"["+this.type+"] "+this.Eg};bc.prototype.reset=function(){for(var a=0;a<this.Ic.length;a++){var b=this.re.id;b&&ac(this.ve,b);ac(this.re,this.Ic[a])}this.Ic.length=0;this.Me.clear();this.eg=ya();this.qf=this.gg=this.hg=this.ig=this.jg=0;b=this.Uc.Lc();for(a=0;a<b.length;a++){var c=this.Uc.get(b[a]);c.count=0;c.time=0;c.Ye=0;ac(this.fg,c)}this.Uc.clear()};
bc.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.Ic.length;d++){var e=this.Ic[d];1==e.se&&c.pop();a.push(" ",ec(e,this.eg,b,c.join("")));b=e.xf;a.push("\n");0==e.se&&c.push("|  ")}if(0!=this.Me.la()){var f=ya();a.push(" Unstopped timers:\n");Pb(this.Me,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",gc(b.startTime),")\n")})}b=this.Uc.Lc();for(d=0;d<b.length;d++)c=this.Uc.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",this.gg,"\n","Total comments created ",
this.qf,"\n","Overhead start: ",this.jg," ms\n","Overhead end: ",this.ig," ms\n","Overhead comment: ",this.hg," ms\n");return a.join("")};function fc(a){var a=Math.round(a),b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function gc(a){a=Math.round(a);return(""+(100+a/1E3%60)).substring(1,3)+"."+(""+(1E3+a%1E3)).substring(1,4)}new bc;function hc(){}var ic=0;u=hc.prototype;u.key=0;u.kc=r;u.he=r;u.aa=function(a,b,c,d,e,f){ma(a)?this.Jf=n:a&&a.handleEvent&&ma(a.handleEvent)?this.Jf=r:i(Error("Invalid listener argument"));this.Nc=a;this.ag=b;this.src=c;this.type=d;this.capture=!!e;this.te=f;this.he=r;this.key=++ic;this.kc=r};u.handleEvent=function(a){return this.Jf?this.Nc.call(this.te||this.src,a):this.Nc.handleEvent.call(this.Nc,a)};!H||qb(9);var jc=!H||qb(9),kc=H&&!nb("8");!Ya||nb("528");Xa&&nb("1.9b")||H&&nb("8")||Wa&&nb("9.5")||Ya&&nb("528");!Xa||nb("8");function lc(a,b){this.type=a;this.currentTarget=this.target=b}D(lc,Xb);u=lc.prototype;u.G=function(){delete this.type;delete this.target;delete this.currentTarget};u.Vb=r;u.Sc=n;u.stopPropagation=function(){this.Vb=n};u.preventDefault=function(){this.Sc=r};function mc(a){mc[" "](a);return a}mc[" "]=fa;function nc(a,b){a&&this.aa(a,b)}D(nc,lc);u=nc.prototype;u.target=q;u.relatedTarget=q;u.offsetX=0;u.offsetY=0;u.clientX=0;u.clientY=0;u.screenX=0;u.screenY=0;u.button=0;u.keyCode=0;u.charCode=0;u.ctrlKey=r;u.altKey=r;u.shiftKey=r;u.metaKey=r;u.Ma=q;
u.aa=function(a,b){var c=this.type=a.type;lc.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;if(d){if(Xa){var e;a:{try{mc(d.nodeName);e=n;break a}catch(f){}e=r}e||(d=q)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.relatedTarget=d;this.offsetX=Ya||a.offsetX!==k?a.offsetX:a.layerX;this.offsetY=Ya||a.offsetY!==k?a.offsetY:a.layerY;this.clientX=a.clientX!==k?a.clientX:a.pageX;this.clientY=a.clientY!==k?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.state=a.state;this.Ma=a;delete this.Sc;delete this.Vb};u.stopPropagation=function(){nc.h.stopPropagation.call(this);this.Ma.stopPropagation?this.Ma.stopPropagation():this.Ma.cancelBubble=n};
u.preventDefault=function(){nc.h.preventDefault.call(this);var a=this.Ma;if(a.preventDefault)a.preventDefault();else if(a.returnValue=r,kc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};u.Tg=s("Ma");u.G=function(){nc.h.G.call(this);this.relatedTarget=this.currentTarget=this.target=this.Ma=q};var oc={},pc={},qc={},rc={};
function I(a,b,c,d,e){if(b){if(ia(b)){for(var f=0;f<b.length;f++)I(a,b[f],c,d,e);return q}var d=!!d,g=pc;b in g||(g[b]={F:0,va:0});g=g[b];d in g||(g[d]={F:0,va:0},g.F++);var g=g[d],h=oa(a),j;g.va++;if(g[h]){j=g[h];for(f=0;f<j.length;f++)if(g=j[f],g.Nc==c&&g.te==e){if(g.kc)break;return j[f].key}}else j=g[h]=[],g.F++;f=sc();f.src=a;g=new hc;g.aa(c,f,a,b,d,e);c=g.key;f.key=c;j.push(g);oc[c]=g;qc[h]||(qc[h]=[]);qc[h].push(g);a.addEventListener?(a==ea||!a.uf)&&a.addEventListener(b,f,d):a.attachEvent(b in
rc?rc[b]:rc[b]="on"+b,f);return c}i(Error("Invalid event type"))}function sc(){var a=tc,b=jc?function(c){return a.call(b.src,b.key,c)}:function(c){c=a.call(b.src,b.key,c);if(!c)return c};return b}function uc(a,b,c,d,e){if(ia(b))for(var f=0;f<b.length;f++)uc(a,b[f],c,d,e);else a=I(a,b,c,d,e),oc[a].he=n}
function vc(a,b,c,d,e){if(ia(b))for(var f=0;f<b.length;f++)vc(a,b[f],c,d,e);else{d=!!d;a:{f=pc;if(b in f&&(f=f[b],d in f&&(f=f[d],a=oa(a),f[a]))){a=f[a];break a}a=q}if(a)for(f=0;f<a.length;f++)if(a[f].Nc==c&&a[f].capture==d&&a[f].te==e){wc(a[f].key);break}}}
function wc(a){if(!oc[a])return r;var b=oc[a];if(b.kc)return r;var c=b.src,d=b.type,e=b.ag,f=b.capture;c.removeEventListener?(c==ea||!c.uf)&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(d in rc?rc[d]:rc[d]="on"+d,e);c=oa(c);e=pc[d][f][c];if(qc[c]){var g=qc[c];Cb(g,b);0==g.length&&delete qc[c]}b.kc=n;e.Qf=n;xc(d,f,c,e);delete oc[a];return n}
function xc(a,b,c,d){if(!d.Cd&&d.Qf){for(var e=0,f=0;e<d.length;e++)d[e].kc?d[e].ag.src=q:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.Qf=r;0==f&&(delete pc[a][b][c],pc[a][b].F--,0==pc[a][b].F&&(delete pc[a][b],pc[a].F--),0==pc[a].F&&delete pc[a])}}function yc(a){var b,c=0,d=b==q;b=!!b;if(a==q)rb(qc,function(a){for(var e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)wc(f.key),c++}});else if(a=oa(a),qc[a])for(var a=qc[a],e=a.length-1;0<=e;e--){var f=a[e];if(d||b==f.capture)wc(f.key),c++}}
function Bc(a){var b=Cc,a=oa(a),c=qc[a];if(c){var d=ha(b),e=ha(k);return d&&e?(c=pc[b],!!c&&!!c[k]&&a in c[k]):!d&&!e?n:Ab(c,function(a){return d&&a.type==b||e&&a.capture==k})}return r}function Dc(a,b,c,d,e){var f=1,b=oa(b);if(a[b]){a.va--;a=a[b];a.Cd?a.Cd++:a.Cd=1;try{for(var g=a.length,h=0;h<g;h++){var j=a[h];j&&!j.kc&&(f&=Ec(j,e)!==r)}}finally{a.Cd--,xc(c,d,b,a)}}return Boolean(f)}function Ec(a,b){var c=a.handleEvent(b);a.he&&wc(a.key);return c}
function tc(a,b){if(!oc[a])return n;var c=oc[a],d=c.type,e=pc;if(!(d in e))return n;var e=e[d],f,g;if(!jc){var h;if(!(h=b))a:{h=["window","event"];for(var j=ea;f=h.shift();)if(x(j[f]))j=j[f];else{h=q;break a}h=j}f=h;h=n in e;j=r in e;if(h){if(0>f.keyCode||f.returnValue!=k)return n;a:{var l=r;if(0==f.keyCode)try{f.keyCode=-1;break a}catch(m){l=n}if(l||f.returnValue==k)f.returnValue=n}}l=new nc;l.aa(f,this);f=n;try{if(h){for(var p=[],t=l.currentTarget;t;t=t.parentNode)p.push(t);g=e[n];g.va=g.F;for(var o=
p.length-1;!l.Vb&&0<=o&&g.va;o--)l.currentTarget=p[o],f&=Dc(g,p[o],d,n,l);if(j){g=e[r];g.va=g.F;for(o=0;!l.Vb&&o<p.length&&g.va;o++)l.currentTarget=p[o],f&=Dc(g,p[o],d,r,l)}}else f=Ec(c,l)}finally{p&&(p.length=0),l.Da()}return f}d=new nc(b,this);try{f=Ec(c,d)}finally{d.Da()}return f}var Fc=0;function Gc(a){return a+"_"+Fc++};function Hc(){}D(Hc,Xb);u=Hc.prototype;u.uf=n;u.Ed=q;u.Pe=ca("Ed");u.addEventListener=function(a,b,c,d){I(this,a,b,c,d)};u.removeEventListener=function(a,b,c,d){vc(this,a,b,c,d)};
u.dispatchEvent=function(a){var b=a.type||a,c=pc;if(b in c){if(la(a))a=new lc(a,this);else if(a instanceof lc)a.target=a.target||this;else{var d=a,a=new lc(b,this);vb(a,d)}var d=1,e,c=c[b],b=n in c,f;if(b){e=[];for(f=this;f;f=f.Ed)e.push(f);f=c[n];f.va=f.F;for(var g=e.length-1;!a.Vb&&0<=g&&f.va;g--)a.currentTarget=e[g],d&=Dc(f,e[g],a.type,n,a)&&a.Sc!=r}if(r in c)if(f=c[r],f.va=f.F,b)for(g=0;!a.Vb&&g<e.length&&f.va;g++)a.currentTarget=e[g],d&=Dc(f,e[g],a.type,r,a)&&a.Sc!=r;else for(e=this;!a.Vb&&e&&
f.va;e=e.Ed)a.currentTarget=e,d&=Dc(f,e,a.type,r,a)&&a.Sc!=r;a=Boolean(d)}else a=n;return a};u.G=function(){Hc.h.G.call(this);yc(this);this.Ed=q};function K(){this.c="base";this.ta=window["X.counter"].qi();this.d=r}D(K,Hc);K.prototype.__defineGetter__("classname",s("c"));K.prototype.__defineGetter__("id",s("ta"));B("X.base",K);function Ic(a,b){this.oa=new za(a);this.S=new za(b)}Ic.prototype={f:function(){return new Ic(this.oa.f(),this.S.f())},Rb:function(){this.S=this.S.Fe()},hh:function(a,b){return new Ic(this.oa.Kf(a.oa,b),this.S.Kf(a.S,b))}};function Jc(a,b){this.S=a;this.Xc=b}Jc.prototype={f:function(){return new Jc(this.S.f(),this.Xc)},Rb:function(){this.S=this.S.Fe();this.Xc=-this.Xc}};function Kc(a,b){this.$a=a;this.Ld=b;var c=a[0].oa,d=a[2].oa,d=a[1].oa.Pc(c).ne(d.Pc(c)).Vc();this.na=new Jc(d,d.fc(c))}
Kc.prototype={f:function(){var a=this.$a.map(function(a){return a.f()});return new Kc(a,this.Ld)},Rb:function(){this.$a.reverse().map(function(a){a.Rb()});this.na.Rb()},dg:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.$a.length;h++){var j=a.S.fc(this.$a[h].oa)-a.Xc,j=-1.0E-5>j?2:1.0E-5<j?1:0,f=f|j;g.push(j)}switch(f){case 0:(0<a.S.fc(this.na.S)?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.$a.length;h++){var l=(h+1)%this.$a.length,j=g[h],
m=g[l],f=this.$a[h],l=this.$a[l];2!=j&&b.push(f);1!=j&&c.push(2!=j?f.f():f);3==(j|m)&&(j=(a.Xc-a.S.fc(f.oa))/a.S.fc(l.oa.Pc(f.oa)),j=f.hh(l,j),b.push(j),c.push(j.f()))}3<=b.length&&d.push(new Kc(b,this.Ld));3<=c.length&&e.push(new Kc(c,this.Ld))}}};function Lc(a){this.V=this.W=this.na=q;this.u=[];a&&this.cc(a)}
Lc.prototype={f:function(){var a=new Lc;a.Yh(this.na&&this.na.f());a.Xh(this.W&&this.W.f());a.Wh(this.V&&this.V.f());a.Jd(this.u.map(function(a){return a.f()}));return a},P:function(){for(var a=0;a<this.u.length;a++)this.u[a].Rb();this.na.Rb();this.W&&this.W.P();this.V&&this.V.P();a=this.W;this.W=this.V;this.V=a},ke:function(a){if(!this.na)return a.slice();for(var b=[],c=[],d=0;d<a.length;d++)a[d].dg(this.na,b,c,b,c);this.W&&(b=this.W.ke(b));c=this.V?this.V.ke(c):[];return b.concat(c)},Ca:function(a){this.u=
a.ke(this.u);this.W&&this.W.Ca(a);this.V&&this.V.Ca(a)},rb:function(){var a=this.u.slice();this.W&&(a=a.concat(this.W.rb()));this.V&&(a=a.concat(this.V.rb()));return a},cc:function(a){if(a.length){this.na||(this.na=a[0].na.f());for(var b=[],c=[],d=0;d<a.length;d++)a[d].dg(this.na,this.u,this.u,b,c);b.length&&(this.W||(this.W=new Lc),this.W.cc(b));c.length&&(this.V||(this.V=new Lc),this.V.cc(c))}},Yh:ca("na"),Xh:ca("W"),Wh:ca("V"),Jd:ca("u")};function Mc(){this.u=[]}function Nc(a){var b=new Mc;b.Jd(a);return b}
Mc.prototype={f:function(){var a=new Mc;a.Jd(this.u.map(function(a){return a.f()}));return a},Ve:function(a){var b=new Lc(this.f().u),a=new Lc(a.f().u);b.Ca(a);a.Ca(b);a.P();a.Ca(b);a.P();b.cc(a.rb());return Nc(b.rb())},Za:function(a){var b=new Lc(this.f().u),a=new Lc(a.f().u);b.P();b.Ca(a);a.Ca(b);a.P();a.Ca(b);a.P();b.cc(a.rb());b.P();return Nc(b.rb())},xe:function(a){var b=new Lc(this.f().u),a=new Lc(a.f().u);b.P();a.Ca(b);a.P();b.Ca(a);a.Ca(b);b.cc(a.rb());b.P();return Nc(b.rb())},inverse:function(){var a=
this.f();a.u.map(function(a){a.Rb()});return a},Jd:ca("u")};function Oc(){K.call(this);this.c="indexer";this.fe=[];this.ca={}}D(Oc,K);Oc.prototype.add=function(a){x(a)||i(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.ca||(this.ca[b]=this.fe.length,this.fe.push(a));return this.ca[b]};Oc.prototype.unique=s("fe");function Pc(a){K.call(this);this.c="file";this.$d=a;this.d=n}D(Pc,K);function Qc(){this.ad=this.t=q}Qc.prototype.__defineSetter__("file",function(a){this.t=x(a)?new Pc(a):q});Qc.prototype.__defineGetter__("file",function(){return!this.t?"":this.t.$d});Qc.prototype.__defineGetter__("filedata",s("ad"));Qc.prototype.__defineSetter__("filedata",ca("ad"));function Sc(){K.call(this);this.c="colortable";this.ca=new Qb;Ca(this,new Qc)}D(Sc,K);Sc.prototype.add=function(a,b,c,d,e,f){(!y(a)||!y(c)||!y(d)||!y(e)||!y(f))&&i(Error("Invalid color table entry."));this.ca.set(a,[b,c,d,e,f]);this.d=n};function Tc(a,b,c){this.x=ha(a)?a:0;this.y=ha(b)?b:0;this.b=ha(c)?c:0}Tc.prototype.f=function(){return new Tc(this.x,this.y,this.b)};Tc.prototype.Ue=function(){return[this.x,this.y,this.b]};function L(a,b,c){this.x=a;this.y=b;this.b=c}D(L,Tc);u=L.prototype;u.f=function(){return new L(this.x,this.y,this.b)};u.Ub=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.b*this.b)};u.scale=function(a){this.x*=a;this.y*=a;this.b*=a;return this};u.P=function(){this.x=-this.x;this.y=-this.y;this.b=-this.b;return this};u.normalize=function(){return this.scale(1/this.Ub())};u.add=function(a){this.x+=a.x;this.y+=a.y;this.b+=a.b;return this};
u.Za=function(a){this.x-=a.x;this.y-=a.y;this.b-=a.b;return this};u.Hc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.b==a.b};function Uc(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.b-b.b;return Math.sqrt(c*c+d*d+e*e)}function Vc(a,b){return new L(a.x+b.x,a.y+b.y,a.b+b.b)}function Wc(a,b){return new L(a.y*b.b-a.b*b.y,a.b*b.x-a.x*b.b,a.x*b.y-a.y*b.x)};function Xc(a,b){this.x=ha(a)?a:0;this.y=ha(b)?b:0}Xc.prototype.f=function(){return new Xc(this.x,this.y)};function Yc(a,b){return new Xc(a.x-b.x,a.y-b.y)};function Zc(a,b){this.x=a;this.y=b}D(Zc,Xc);u=Zc.prototype;u.f=function(){return new Zc(this.x,this.y)};u.Ub=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};u.scale=function(a){this.x*=a;this.y*=a;return this};u.P=function(){this.x=-this.x;this.y=-this.y;return this};u.normalize=function(){return this.scale(1/this.Ub())};u.add=function(a){this.x+=a.x;this.y+=a.y;return this};u.Za=function(a){this.x-=a.x;this.y-=a.y;return this};
u.rotate=function(a){var b=Math.cos(a),a=Math.sin(a),c=this.y*b+this.x*a;this.x=this.x*b-this.y*a;this.y=c;return this};u.Hc=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y};function $c(a,b){this.width=a;this.height=b}function ad(a,b){return a==b?n:!a||!b?r:a.width==b.width&&a.height==b.height}$c.prototype.f=function(){return new $c(this.width,this.height)};$c.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};$c.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};$c.prototype.scale=function(a){this.width*=a;this.height*=a;return this};function bd(a,b){if(a instanceof bd)this.J=a.Ue();else{var c;if(c=ja(a))a:{for(var d=c=0;d<a.length;d++){if(!ja(a[d])||0<c&&a[d].length!=c){c=r;break a}for(var e=0;e<a[d].length;e++)if(!y(a[d][e])){c=r;break a}0==c&&(c=a[d].length)}c=0!=c}c?this.J=Hb(a):a instanceof $c?this.J=gd(a.height,a.width):y(a)&&y(b)&&0<a&&0<b?this.J=gd(a,b):i(Error("Invalid argument(s) for Matrix contructor"))}this.z=new $c(this.J[0].length,this.J.length)}
function hd(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new bd(b)}function id(a,b,c){for(var d=0;d<a.ma().height;d++)for(var e=0;e<a.ma().width;e++)b.call(c,a.J[d][e],d,e,a)}function jd(a,b){var c=new bd(a.ma());id(a,function(d,e,f){c.J[e][f]=b.call(k,d,e,f,a)});return c}function gd(a,b){for(var c=[],d=0;d<a;d++){c[d]=[];for(var e=0;e<b;e++)c[d][e]=0}return c}u=bd.prototype;
u.add=function(a){ad(this.z,a.ma())||i(Error("Matrix summation is only supported on arrays of equal size"));return jd(this,function(b,c,d){return b+a.J[c][d]})};u.Hc=function(a,b){if(this.z.width!=a.z.width||this.z.height!=a.z.height)return r;for(var c=b||0,d=0;d<this.z.height;d++)for(var e=0;e<this.z.width;e++)if(!(Math.abs(this.J[d][e]-a.J[d][e])<=(c||1.0E-6)))return r;return n};u.ma=s("z");u.L=function(a,b){return!(0<=a&&a<this.z.height&&0<=b&&b<this.z.width)?q:this.J[a][b]};
function N(a,b,c,d){0<=b&&b<a.z.height&&0<=c&&c<a.z.width||i(Error("Index out of bounds when setting matrix value, ("+b+","+c+") in size ("+a.z.height+","+a.z.width+")"));a.J[b][c]=d}u.multiply=function(a){if(a instanceof bd)return this.z.width!=a.ma().height&&i(Error("Invalid matrices for multiplication. Second matrix should have the same number of rows as the first has columns.")),kd(this,a);if(y(a))return ld(this,a);i(Error("A matrix can only be multiplied by a number or another matrix."))};
u.Za=function(a){ad(this.z,a.ma())||i(Error("Matrix subtraction is only supported on arrays of equal size."));return jd(this,function(b,c,d){return b-a.J[c][d]})};u.Ue=s("J");function kd(a,b){var c=new bd(a.z.height,b.ma().width);id(c,function(a,e,f){for(var g=a=0;g<this.z.width;g++)a+=this.L(e,g)*b.L(g,f);N(c,e,f,a)},a);return c}function ld(a,b){return jd(a,function(a){return a*b})};function O(a,b){bd.call(this,a,b);this.c="matrix"}D(O,bd);function md(a){for(var b=[],c=0;c<a;c++){b[c]=[];for(var d=0;d<a;d++)b[c][d]=c==d?1:0}return new O(b)}u=O.prototype;u.K=function(){var a=[],b=this.ma();if(0==b.height||0==b.width)return[];var c,d;for(d=0;d<b.height;d++)for(c=0;c<b.width;c++)a.push(this.L(c,d));return a};
u.translate=function(a){this.z.width!=this.z.height&&i(Error("Can not translate non-square matrix."));var b=this.ma(),c=hd(b.height);a instanceof Zc&&3==b.height?(N(c,0,2,a.x),N(c,1,2,a.y)):a instanceof L&&4==b.height?(N(c,0,3,a.x),N(c,1,3,a.y),N(c,2,3,a.b)):i(Error("Translation failed."));return new O(this.multiply(c))};
u.rotate=function(a,b){(4!=this.ma().height||this.z.width!=this.z.height)&&i(Error("Only 4x4 matrices can be rotated."));(!x(b)||!(b instanceof L))&&i(Error("Invalid axis vector."));y(a)||i(Error("Invalid angle."));var c=b.normalize(),d=Math.cos(a),e=Math.sin(a),f=hd(4);N(f,0,0,d+c.x*c.x*(1-d));N(f,0,1,c.x*c.y*(1-d)-c.b*e);N(f,0,2,c.x*c.b*(1-d)+c.y*e);N(f,1,0,c.y*c.x*(1-d)+c.b*e);N(f,1,1,d+c.y*c.y*(1-d));N(f,1,2,c.y*c.b*(1-d)-c.x*e);N(f,2,0,c.b*c.x*(1-d)-c.y*e);N(f,2,1,c.b*c.y*(1-d)+c.x*e);N(f,2,
2,d+c.b*c.b*(1-d));return new O(this.multiply(f))};u.Fa=function(a){var b=this.ma(),c=Array(b.width),d;for(d=0;d<c.length;d++)c[d]=Array(1),c[d][0]=1;a instanceof L&&3<=b.width?(c[0][0]=a.x,c[1][0]=a.y,c[2][0]=a.b):i(Error("Multiplication by vector failed."));a=this.multiply(new bd(c));return new L(parseFloat(a.L(0,0)),parseFloat(a.L(1,0)),parseFloat(a.L(2,0)))};u.ki=function(a,b){var c=this.J[a];this.J[a]=this.J[b];this.J[b]=c};
u.ji=function(a,b){for(var c=this.ma(),d=0,d=0;d<c.height;d++){var e=this.L(d,a);e||(e=0);var f=this.L(d,b);f||(f=0);N(this,d,a,f);N(this,d,b,e)}};B("X.matrix",O);B("X.matrix.createIdentityMatrix",md);B("X.matrix.prototype.flatten",O.prototype.K);B("X.matrix.prototype.translate",O.prototype.translate);B("X.matrix.prototype.rotate",O.prototype.rotate);B("X.matrix.prototype.toArray",O.prototype.Ue);B("X.matrix.prototype.getValueAt",O.prototype.L);B("X.matrix.prototype.multiplyByVector",O.prototype.Fa);
B("X.matrix.prototype.swapRows",O.prototype.ki);B("X.matrix.prototype.swapCols",O.prototype.ji);function nd(){K.call(this);this.c="transform";this.l=md(4);this.Pa=new Float32Array(this.l.K())}D(nd,K);nd.prototype.__defineGetter__("matrix",s("l"));nd.prototype.__defineSetter__("matrix",function(a){(!x(a)||!(a instanceof O))&&i(Error("Invalid matrix."));this.l=a;this.Pa=new Float32Array(this.l.K());this.d=n});u=nd.prototype;u.Qh=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new L(0,1,0));this.Pa=new Float32Array(this.l.K());this.d=n};
u.Rh=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new L(1,0,0));this.Pa=new Float32Array(this.l.K());this.d=n};u.Sh=function(a){(!y(a)||-360>a||360<a)&&i(Error("Invalid angle."));this.l=this.l.rotate(a*Math.PI/180,new L(0,0,1));this.Pa=new Float32Array(this.l.K());this.d=n};u.ni=function(a){y(a)||i(Error("Invalid distance."));this.l=this.l.translate(new L(a,0,0));this.Pa=new Float32Array(this.l.K());this.d=n};
u.oi=function(a){y(a)||i(Error("Invalid distance."));this.l=this.l.translate(new L(0,a,0));this.Pa=new Float32Array(this.l.K());this.d=n};u.pi=function(a){y(a)||i(Error("Invalid distance."));this.l=this.l.translate(new L(0,0,a));this.Pa=new Float32Array(this.l.K());this.d=n};function od(a,b,c){var d=a.l.L(b,c);d||(d=0);N(a.l,b,c,-1*d);a.Pa=new Float32Array(a.l.K());a.d=n}u.Pg=function(){od(this,0,0)};u.Qg=function(){od(this,1,1)};u.Rg=function(){od(this,2,2)};B("X.transform",nd);
B("X.transform.prototype.rotateX",nd.prototype.Qh);B("X.transform.prototype.rotateY",nd.prototype.Rh);B("X.transform.prototype.rotateZ",nd.prototype.Sh);B("X.transform.prototype.translateX",nd.prototype.ni);B("X.transform.prototype.translateY",nd.prototype.oi);B("X.transform.prototype.translateZ",nd.prototype.pi);B("X.transform.prototype.flipX",nd.prototype.Pg);B("X.transform.prototype.flipY",nd.prototype.Qg);B("X.transform.prototype.flipZ",nd.prototype.Rg);function pd(){K.call(this);this.c="texture";this.nb=this.Ab=this.t=q;this.gd=this.hd=0;Ca(this,new Qc)}D(pd,K);B("X.texture",pd);function P(a){K.call(this);this.c="triplets";this.Gb=Infinity;this.Db=-Infinity;this.Hb=Infinity;this.Eb=-Infinity;this.Ib=Infinity;this.Fb=-Infinity;this.Yc=[0,0,0];this.U=[];x(a)&&(this.U=a.U.slice(),this.Gb=a.Gb,this.Db=a.Db,this.Hb=a.Hb,this.Eb=a.Eb,this.Ib=a.Ib,this.Fb=a.Fb,this.Yc=a.Yc.slice())}D(P,K);
P.prototype.add=function(a,b,c){(!y(a)||!y(b)||!y(c))&&i(Error("Invalid triplet."));this.Gb=Math.min(this.Gb,a);this.Db=Math.max(this.Db,a);this.Hb=Math.min(this.Hb,b);this.Eb=Math.max(this.Eb,b);this.Ib=Math.min(this.Ib,c);this.Fb=Math.max(this.Fb,c);this.Yc=[(this.Gb+this.Db)/2,(this.Hb+this.Eb)/2,(this.Ib+this.Fb)/2];this.d=n;return this.U.push(a,b,c)/3};
P.prototype.get=function(a){(!y(a)||0>a||3*a>this.U.length||a==this.U.length/3)&&i(Error("Invalid id."));a*=3;return[this.U[a],this.U[a+1],this.U[a+2]]};P.prototype.remove=function(a){(!y(a)||0>a||3*a>this.U.length||a==this.count)&&i(Error("Invalid id."));this.U.splice(a,3);this.d=n};P.prototype.clear=function(){this.U=[];this.d=n};P.prototype.__defineGetter__("count",function(){return this.U.length/3});P.prototype.__defineGetter__("length",function(){return this.U.length});B("X.triplets",P);
B("X.triplets.prototype.add",P.prototype.add);B("X.triplets.prototype.get",P.prototype.get);B("X.triplets.prototype.remove",P.prototype.remove);B("X.triplets.prototype.clear",P.prototype.clear);function qd(){this.ka=rd;this.Mb=new nd;this.wb=[1,1,1];this.k=new P;this.m=new P;this.xa=new P;this.Lb=this.$=q;this.Ac=[];this.Aa=n;this.bc=this.Bc=1;this.Yb=q;this.tc=r;this.O=1;this.N=0}var rd="TRIANGLES";qd.prototype.__defineGetter__("texture",function(){this.$||(this.$=new pd);return this.$});qd.prototype.__defineGetter__("transform",s("Mb"));qd.prototype.__defineGetter__("points",s("k"));qd.prototype.__defineGetter__("normals",s("m"));qd.prototype.__defineGetter__("colors",s("xa"));
qd.prototype.__defineGetter__("color",s("wb"));qd.prototype.__defineSetter__("color",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid color."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this.wb=a;this.d=n});qd.prototype.__defineGetter__("opacity",s("O"));qd.prototype.__defineSetter__("opacity",function(a){(!y(a)||1<a||0>a)&&i(Error("Invalid opacity."));for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].opacity=a;this.O=a;this.d=n});
qd.prototype.__defineGetter__("caption",s("Yb"));qd.prototype.__defineSetter__("caption",function(a){this.Yb=a;this.d=n});qd.prototype.__defineGetter__("visible",s("Aa"));qd.prototype.__defineSetter__("visible",function(a){for(var b=this.e,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this.Aa=a;this.d=n});qd.prototype.__defineGetter__("pointsize",s("Bc"));qd.prototype.__defineSetter__("pointsize",function(a){y(a)||i(Error("Invalid point size."));this.Bc=a;this.d=n});
qd.prototype.__defineGetter__("magicmode",s("tc"));qd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&i(Error("Invalid magic mode setting."));this.tc=a;this.d=n});qd.prototype.__defineGetter__("linewidth",s("bc"));qd.prototype.__defineSetter__("linewidth",function(a){y(a)||i(Error("Invalid line width."));this.bc=a;this.d=n});function sd(){this.Ja=Infinity;this.ba=this.za=-Infinity;this.da=Infinity;this.kb=[0,0,0];this.ib=[1,1,1]}sd.prototype.__defineGetter__("lowerThreshold",s("ba"));sd.prototype.__defineSetter__("lowerThreshold",function(a){a>=this.Ja&&a<=this.za&&(this.ba=a)});sd.prototype.__defineGetter__("upperThreshold",s("da"));sd.prototype.__defineSetter__("upperThreshold",function(a){a>=this.Ja&&a<=this.za&&(this.da=a)});sd.prototype.__defineGetter__("min",s("Ja"));sd.prototype.__defineGetter__("max",s("za"));
sd.prototype.__defineGetter__("minColor",s("kb"));sd.prototype.__defineSetter__("minColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid min. color."));this.kb=a});sd.prototype.__defineGetter__("maxColor",s("ib"));sd.prototype.__defineSetter__("maxColor",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid max. color."));this.ib=a});function td(){K.call(this);this.c="scalars";this.oc=this.r=q;this.mf=n;Ca(this,new Qc);Ca(this,new sd);this.kb=[0,1,0];this.ib=[1,0,0]}D(td,K);td.prototype.__defineGetter__("array",s("r"));td.prototype.__defineSetter__("array",function(a){this.oc=this.r=a;this.d=n});B("X.scalars",td);function S(a){K.call(this);this.c="object";this.e=[];this.q=this.Q=q;Ca(this,new qd);x(a)&&this.Pb(a)}D(S,K);
S.prototype.Pb=function(a){this.ka=a.ka;this.Mb=new nd;this.Mb.l=new O(a.Mb.l.J);this.wb=a.wb.slice();this.k=new P(a.k);this.m=new P(a.m);this.xa=new P(a.xa);this.$=a.$;this.Lb=a.Lb;a.t&&(this.t=new Pc((new String(a.t.$d)).toString()));this.O=a.O;this.e.length=0;var b=a.e;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this.e.push(new G[b[d].c](b[d]));this.Aa=a.Aa;this.Bc=a.Bc;this.bc=a.bc;a.Yb&&(this.Yb=(new String(a.Yb)).toString());this.tc=a.tc;this.Ac=a.Ac.slice();this.d=n};
S.prototype.__defineGetter__("colortable",function(){this.Q||(this.Q=new Sc);return this.Q});S.prototype.__defineGetter__("scalars",function(){this.q||(this.q=new td);return this.q});S.prototype.__defineGetter__("children",s("e"));S.prototype.B=function(){var a=new ud;a.Z=this;this.dispatchEvent(a)};function vd(a,b){(!x(a)||!x(b)||!(a instanceof S)||!(b instanceof S))&&i(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.O?-1:1==b.O?1:x(a.N)&&x(b.N)&&a.N>b.N?-1:1}
B("X.object",S);B("X.object.prototype.modified",S.prototype.B);function wd(){}function xd(a){for(var b=a.k.count,c=[],d=0,d=0;d<b;d+=3){var e=a.k.get(d),f=a.k.get(d+1),g=a.k.get(d+2),h=a.m.get(d),j=a.m.get(d+1),l=a.m.get(d+2),m=a.wb;0<a.xa.length&&(m=a.xa.get(d));var p=[];p.push(new Ic(e,h));p.push(new Ic(f,j));p.push(new Ic(g,l));c.push(new Kc(p,m))}return Nc(c)}
function yd(a,b){(!x(b)||!(b instanceof Mc))&&i(Error("Invalid CSG object."));a.k.clear();a.m.clear();a.xa.clear();var c=new Oc,d=[];zb(b.u,function(a){for(var b=[],g=a.Ld,b=zb(a.$a,function(a){a.color=g;return c.add(a)}),a=a=2;a<b.length;a++)d.push([b[0],b[a-1],b[a]])}.bind(a));a.ug=zb(c.unique(),function(a){return[a.oa.x(),a.oa.y(),a.oa.b()]});a.tg=zb(c.unique(),function(a){return[a.S.x(),a.S.y(),a.S.b()]});a.sg=zb(c.unique(),function(a){return!a.color?q:[a.color[0],a.color[1],a.color[2]]});zb(d,
function(a){var b=a[0],c=a[1],a=a[2],d=this.ug,j=this.tg,l=this.sg;this.k.add(d[b][0],d[b][1],d[b][2]);this.k.add(d[c][0],d[c][1],d[c][2]);this.k.add(d[a][0],d[a][1],d[a][2]);this.m.add(j[b][0],j[b][1],j[b][2]);this.m.add(j[c][0],j[c][1],j[c][2]);this.m.add(j[a][0],j[a][1],j[a][2]);l[b]&&this.xa.add(l[b][0],l[b][1],l[b][2]);l[c]&&this.xa.add(l[c][0],l[c][1],l[c][2]);l[a]&&this.xa.add(l[a][0],l[a][1],l[a][2])}.bind(a));a.ka=rd}
wd.prototype.Ve=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=xd(b));a=new S;Ca(a,new wd);yd(a,xd(this).Ve(b));return a};wd.prototype.Za=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=xd(b));a=new S;Ca(a,new wd);yd(a,xd(this).Za(b));return a};
wd.prototype.xe=function(a){(!x(a)||!(a instanceof Mc)&&!(a instanceof S))&&i(Error("Invalid object."));var b=a;a instanceof S&&(b=xd(b));a=new S;Ca(a,new wd);yd(a,xd(this).xe(b));return a};wd.prototype.inverse=function(){var a=new S;Ca(a,new wd);yd(a,xd(this).inverse());return a};B("X.constructable",wd);B("X.constructable.prototype.intersect",wd.prototype.xe);B("X.constructable.prototype.inverse",wd.prototype.inverse);B("X.constructable.prototype.subtract",wd.prototype.Za);
B("X.constructable.prototype.union",wd.prototype.Ve);function zd(a){lc.call(this,a);this.c="event"}D(zd,lc);var Ad=Gc("pan"),Bd=Gc("rotate"),Cd=Gc("zoom"),Dd=Gc("scroll");Gc("render");var Ed=Gc("resetview"),Cc=Gc("modified"),Fd=Gc("progress"),Gd=Gc("hover"),Hd=Gc("hover_end");function Id(){zd.call(this,Ad);this.N=new Zc(0,0)}D(Id,zd);function Jd(){zd.call(this,Bd);this.N=new Zc(0,0)}D(Jd,zd);function Kd(){zd.call(this,Cd);this.ab=this.Bb=r}D(Kd,zd);function Ld(){zd.call(this,Dd);this.C=r}D(Ld,zd);function Md(){zd.call(this,Gd);this.pd=this.od=0}
D(Md,zd);function Nd(){zd.call(this,Hd)}D(Nd,zd);function Od(){zd.call(this,Ed)}D(Od,zd);function ud(){zd.call(this,Cc);this.Z=new S;this.p=q}D(ud,zd);function Pd(){zd.call(this,Fd);this.nf=0}D(Pd,zd);function T(){K.call(this);this.c="parser";this.ha=q;this.ya=0;this.xg=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.cd=n}D(T,K);T.prototype.parse=function(){i(Error("The function parse() should be overloaded."))};function Qd(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function U(a,b,c){x(c)||(c=1);var d=1,e=Uint8Array;switch(b){case "schar":e=Int8Array;break;case "ushort":e=Uint16Array;d=2;break;case "sshort":e=Int16Array;d=2;break;case "uint":e=Uint32Array;d=4;break;case "sint":e=Int32Array;d=4;break;case "float":e=Float32Array,d=4}b=new e(a.ha.slice(a.ya,a.ya+=c*d));if(a.xg!=a.cd){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(e=0;e<a.byteLength;e+=d)for(var f=e+d-1,g=e;f>g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Rd(a,b,c){G.sa(a.c+".reslice");for(var d=b.T,e=c.max,f=c.data,g=d[2],h=d[1],d=d[0],j=b.v!=q,l=h*d,m=Array(g),p=0;p<g;p++){m[p]=Array(h);for(var t=0;t<h;t++)m[p][t]=new c.data.constructor(d)}for(var o=0,c=c=0;c<g;c++){for(var p=f.subarray(c*l,(c+1)*l),t=new Uint8Array(4*l),w=0,v=0,z=0,w=0;w<h;w++)for(v=0;v<d;v++){var o=p[z],A=0,E=0,F=0,C=0;b.Q?((C=b.Q.ca.get(Math.floor(o)))||(C=b.Q.ca.get(b.Q.ca.la()-1)),A=255*C[1],E=255*C[2],F=255*C[3],C=255*C[4]):(A=E=F=255*(o/e),C=255);var J=4*z;t[J]=A;
t[++J]=E;t[++J]=F;t[++J]=C;m[c][w][v]=o;z++}o=new pd;o.nb=t;o.hd=d;o.gd=h;p=b.Va.e[c];p.$=o;j&&(p.v=b.v.Va.e[c].$)}for(w=0;w<h;w++){t=new Uint8Array(4*g*d);for(c=z=0;c<g;c++)for(v=0;v<d;v++)o=m[c][w][v],b.Q?((C=b.Q.ca.get(Math.floor(o)))||(C=b.Q.ca.get(b.Q.ca.la()-1)),A=255*C[1],E=255*C[2],F=255*C[3],C=255*C[4]):(A=E=F=255*(o/e),C=255),J=4*z,t[J]=A,t[++J]=E,t[++J]=F,t[++J]=C,z++;o=new pd;o.nb=t;o.hd=d;o.gd=g;p=b.Ua.e[w];p.$=o;j&&(p.v=b.v.Ua.e[w].$)}for(v=0;v<d;v++){t=new Uint8Array(4*g*h);for(c=z=
0;c<g;c++)for(w=0;w<h;w++)o=m[c][w][v],b.Q?((C=b.Q.ca.get(Math.floor(o)))||(C=b.Q.ca.get(b.Q.ca.la()-1)),A=255*C[1],E=255*C[2],F=255*C[3],C=255*C[4]):(A=E=F=255*(o/e),C=255),J=4*z,t[J]=A,t[++J]=E,t[++J]=F,t[++J]=C,z++;o=new pd;o.nb=t;o.hd=h;o.gd=g;p=b.Ta.e[v];p.$=o;j&&(p.v=b.v.Ta.e[v].$)}G.ga(a.c+".reslice");return m};function Sd(){T.call(this);this.c="parserLBL"}D(Sd,T);
Sd.prototype.parse=function(a,b,c){G.sa(this.c+".parse");var d=b.Ac,e=d.length;0==e&&i(Error("No _pointIndices defined on the X.object."));this.ha=c;for(var f=[],g=U(this,"uchar",c.byteLength),h=g.length,j=r,l=0,c=1;c<h;c++)10==g[c-1]?(l=c,j=n):j&&32==g[c]&&(j=parseInt(String.fromCharCode.apply(q,g.subarray(l,c)),10),f.push(j),j=r);g=b.q.r?b.q.r:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++)l=d[c],l>e&&i(Error("Could not find scalar for vertex.")),
l=g[l],f[h++]=l,f[h++]=l,f[h++]=l;b.q.r=g;b.q.oc=f;b.q.d=n;G.ga(this.c+".parse");d=new ud;d.Z=b;d.p=a;this.dispatchEvent(d)};B("X.parserLBL",Sd);B("X.parserLBL.prototype.parse",Sd.prototype.parse);function Vd(a){this.n=a;this.Lf=I(this.n,Xa?"DOMMouseScroll":"mousewheel",this)}D(Vd,Hc);
Vd.prototype.handleEvent=function(a){var b=0,c=0,d=0,a=a.Ma;if("mousewheel"==a.type){c=1;if(H||Ya&&(Qa||nb("532.0")))c=40;d=Ya&&Pa&&0!=-a.wheelDelta%c?-a.wheelDelta:-a.wheelDelta/c;ha(a.wheelDeltaX)?(b=Ya&&Pa&&0!=-a.wheelDeltaX%c?-a.wheelDeltaX:-a.wheelDeltaX/c,c=Ya&&Pa&&0!=-a.wheelDeltaY%c?-a.wheelDeltaY:-a.wheelDeltaY/c):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=-3),ha(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;y(this.Nf)&&Math.min(Math.max(b,-this.Nf),this.Nf);y(this.Of)&&(c=Math.min(Math.max(c,
-this.Of),this.Of));b=new Wd(d,a,0,c);try{this.dispatchEvent(b)}finally{b.Da()}};Vd.prototype.G=function(){Vd.h.G.call(this);wc(this.Lf);delete this.Lf};function Wd(a,b,c,d){b&&this.aa(b,k);this.type="mousewheel";this.detail=a;this.ec=d}D(Wd,nc);H||Ya&&nb("525");var Xd;function Yd(a,b){var c;c=(c=a.className)&&"function"==typeof c.split?c.split(/\s+/):[];var d=Ib(arguments,1),e;e=c;for(var f=0,g=0;g<d.length;g++)0<=xb(e,d[g])||(e.push(d[g]),f++);e=f==d.length;a.className=c.join(" ");return e};var Zd=!H||qb(9);!Xa&&!H||H&&qb(9)||Xa&&nb("1.9.1");H&&nb("9");function $d(a){return a?new ae(be(a)):Xd||(Xd=new ae)}function ce(a){return la(a)?document.getElementById(a):a}function de(a,b){rb(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in ee?a.setAttribute(ee[d],b):0==d.lastIndexOf("aria-",0)?a.setAttribute(d,b):a[d]=b})}
var ee={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",height:"height",width:"width",usemap:"useMap",frameborder:"frameBorder",maxlength:"maxLength",type:"type"};function fe(a,b,c){return ge(document,arguments)}
function ge(a,b){var c=b[0],d=b[1];if(!Zd&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',Da(d.name),'"');if(d.type){c.push(' type="',Da(d.type),'"');var e={};vb(e,d);d=e;delete d.type}c.push(">");c=c.join("")}c=a.createElement(c);d&&(la(d)?c.className=d:ia(d)?Yd.apply(q,[c].concat(d)):de(c,d));2<b.length&&he(a,c,b);return c}
function he(a,b,c){function d(c){c&&b.appendChild(la(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];ja(f)&&!(na(f)&&0<f.nodeType)?yb(je(f)?Hb(f):f,d):d(f)}}function ke(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function le(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}
function me(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function be(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function je(a){if(a&&"number"==typeof a.length){if(na(a))return"function"==typeof a.item||"string"==typeof a.item;if(ma(a))return"function"==typeof a.item}return r}function ae(a){this.H=a||ea.document||document}u=ae.prototype;
u.wd=$d;u.g=function(a){return la(a)?this.H.getElementById(a):a};u.dc=function(a,b,c){return ge(this.H,arguments)};u.createElement=function(a){return this.H.createElement(a)};u.createTextNode=function(a){return this.H.createTextNode(a)};function ne(a){return"CSS1Compat"==a.H.compatMode}function oe(a){var b=a.H,a=!Ya&&"CSS1Compat"==b.compatMode?b.documentElement:b.body,b=b.parentWindow||b.defaultView;return new Xc(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}u.appendChild=function(a,b){a.appendChild(b)};
u.contains=me;function V(a){(!x(a)||!(a instanceof Element))&&i(Error("Could not add interactor to the given element."));K.call(this);this.c="interactor";this.Zb=a;this.Wd=this.ff=this.ef=this.gf=this.df=this.hf=q;this.Vd=n;this.ob=this.jb=this.Qa=r;this.fd=[0,0];this.Rd=new Zc(0,0);this.M={MOUSEWHEEL_ENABLED:n,MOUSECLICKS_ENABLED:n,KEYBOARD_ENABLED:n,HOVERING_ENABLED:n,CONTEXTMENU_ENABLED:r}}D(V,K);V.prototype.__defineGetter__("config",s("M"));V.prototype.__defineGetter__("leftButtonDown",s("Qa"));
V.prototype.__defineGetter__("middleButtonDown",s("jb"));V.prototype.__defineGetter__("rightButtonDown",s("ob"));
V.prototype.aa=function(){this.M.MOUSEWHEEL_ENABLED?(this.Wd=new Vd(this.Zb),this.hf=I(this.Wd,"mousewheel",this.Qc.bind(this))):(wc(this.hf),this.Wd=q);this.M.MOUSECLICKS_ENABLED?(this.df=I(this.Zb,"mousedown",this.sh.bind(this)),this.gf=I(this.Zb,"mouseup",this.xh.bind(this))):(wc(this.df),wc(this.gf));this.Zb.oncontextmenu=this.M.CONTEXTMENU_ENABLED?q:function(){return r};window.onkeydown=this.M.KEYBOARD_ENABLED?this.Tf.bind(this):q;wc(this.ef);wc(this.ff);this.ef=I(this.Zb,"mousemove",this.uh.bind(this));
this.ff=I(this.Zb,"mouseout",this.vh.bind(this))};V.prototype.sh=function(a){0==a.button?this.Qa=n:1==a.button?this.jb=n:2==a.button&&(this.ob=n);eval("this.onMouseDown("+this.Qa+","+this.jb+","+this.ob+")");pe(this);a.preventDefault()};V.prototype.rh=ba();V.prototype.xh=function(a){0==a.button?this.Qa=r:1==a.button?this.jb=r:2==a.button&&(this.ob=r);eval("this.onMouseUp("+this.Qa+","+this.jb+","+this.ob+")");pe(this);a.preventDefault()};V.prototype.__defineGetter__("mousePosition",s("fd"));u=V.prototype;
u.wh=ba();u.vh=function(a){this.Vd=r;this.M.KEYBOARD_ENABLED&&(window.onkeydown=q);this.ob=this.jb=this.Qa=r;pe(this);this.Rd=new Zc(0,0);a.preventDefault()};u.th=ba();
u.uh=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Vd=n;this.M.KEYBOARD_ENABLED&&window.onkeydown==q&&(window.onkeydown=this.Tf.bind(this));a.preventDefault();var b=a.shiftKey;this.fd=[a.offsetX,a.offsetY];var c=new Zc(this.fd[0],this.fd[1]),a=this.Rd.Za(c);this.Rd=c.f();this.M.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.jb||this.Qa||this.ob)&&pe(this),this.ue=setTimeout(function(){pe(this);var a=new Md;a.od=c.x;a.pd=c.y;this.dispatchEvent(a);
this.ue=q}.bind(this),300));2>Math.abs(a.x)&&(a.x=0);2>Math.abs(a.y)&&(a.y=0);0!=a.Ub()&&(this.Qa&&!b?(b=new Jd,b.N=a,b.fj=0,this.dispatchEvent(b)):this.jb||this.Qa&&b?(b=new Id,5<a.x?a.x=5:-5>a.x&&(a.x=-5),5<a.y?a.y=5:-5>a.y&&(a.y=-5),b.N=a,this.dispatchEvent(b)):this.ob&&(b=new Kd,b.Bb=0<a.y,b.ab=r,this.dispatchEvent(b)))};function pe(a){a.ue&&clearTimeout(a.ue);a.dispatchEvent(new Nd)}u.yh=ba();
u.Qc=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");pe(this);a.preventDefault()};u.ph=ba();
u.Tf=function(a){if(this.Vd){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");pe(this);var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new Od,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new Id:b?a=new Kd:(a=new Jd,this instanceof qe&&(a=new Ld)),a&&(c=new Zc(0,0),37==f?(c.x=5,a.C=r,b&&(a.C=n,a.Bb=n,a.ab=r)):39==f?(c.x=-5,a.C=n,b&&(a.Bb=r,a.ab=r)):38==f?(c.y=5,a.C=n,b&&(a.Bb=n,a.ab=n)):40==f&&(c.y=-5,a.C=r,b&&(a.Bb=r,
a.ab=n)),a.N=c,this.dispatchEvent(a)))}};B("X.interactor",V);B("X.interactor.prototype.init",V.prototype.aa);B("X.interactor.prototype.onMouseDown",V.prototype.rh);B("X.interactor.prototype.onMouseUp",V.prototype.wh);B("X.interactor.prototype.onMouseMove",V.prototype.th);B("X.interactor.prototype.onMouseWheel",V.prototype.yh);B("X.interactor.prototype.onKey",V.prototype.ph);function qe(a){V.call(this,a);this.c="interactor2D"}D(qe,V);qe.prototype.Qc=function(a){qe.h.Qc.call(this,a);var b=new Ld;x(a.ec)||(a.ec=0);b.C=0>a.ec;this.dispatchEvent(b)};function re(a){S.call(this);this.c="slice";this.i=[0,0,0];this.ac=[0,0,1];this.C=[0,1,0];this.A=this.D=10;this.Lb=[0,1,0,0,1,1,1,1,1,0,0,0];this.v=this.Xa=q;this.Ia=n;this.Xb=[1,1,1];x(a)&&this.Pb(a)}D(re,S);re.prototype.Pb=function(a){this.i=a.i.slice();this.ac=a.ac.slice();this.C=a.C.slice();this.D=a.D;this.A=a.A;this.Xa=a.Xa;this.v=a.v;this.Ia=a.Ia;this.Xb=a.Xb;this.wg=a.wg;re.h.Pb.call(this,a)};
re.prototype.Gc=function(){this.k.clear();var a=new L(this.ac[0],this.ac[1],this.ac[2]),b=new L(this.C[0],this.C[1],this.C[2]),c=Wc(b,a),d=new L(this.i[0],this.i[1],this.i[2]),e=new L(1,1,1);1==a.x?(e=new L(this.i[0],this.A/2,this.D/2),this.Lb=[0,0,1,0,0,1,0,1,1,1,1,0]):1==a.y?(e=new L(this.D/2,this.i[1],this.A/2),this.Lb=[0,0,0,1,1,0,1,0,1,1,0,1]):1==a.b&&(e=new L(this.D/2,this.A/2,this.i[2]));var f=Vc(c.f().P(),b.f().P()),f=new L(f.x*e.x,f.y*e.y,f.b*e.b);f.add(d);var g=Vc(c.f().P(),b),g=new L(g.x*
e.x,g.y*e.y,g.b*e.b);g.add(d);var h=Vc(c,b.f().P()),h=new L(h.x*e.x,h.y*e.y,h.b*e.b);h.add(d);var j=h,b=Vc(c,b),b=new L(b.x*e.x,b.y*e.y,b.b*e.b);b.add(d);d=g;this.k.add(f.x,f.y,f.b);this.k.add(g.x,g.y,g.b);this.k.add(h.x,h.y,h.b);this.k.add(j.x,j.y,j.b);this.k.add(b.x,b.y,b.b);this.k.add(d.x,d.y,d.b);this.m.add(a.x,a.y,a.b);this.m.add(a.x,a.y,a.b);this.m.add(a.x,a.y,a.b);this.m.add(a.x,a.y,a.b);this.m.add(a.x,a.y,a.b);this.m.add(a.x,a.y,a.b);this.Ia&&(a=new S,a.k.add(f.x,f.y,f.b),a.k.add(g.x,g.y,
g.b),a.k.add(g.x,g.y,g.b),a.k.add(b.x,b.y,b.b),a.k.add(b.x,b.y,b.b),a.k.add(h.x,h.y,h.b),a.k.add(h.x,h.y,h.b),a.k.add(f.x,f.y,f.b),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.m.add(0,0,0),a.wb=[this.Xb[0],this.Xb[1],this.Xb[2]],a.ka="LINES",a.bc=2,this.e.push(a))};B("X.slice",re);function W(a){S.call(this);this.c="volume";this.i=[0,0,0];this.T=[10,10,10];this.I=[1,1,1];this.Ab=[];this.rc=this.fb=this.qc=this.eb=this.pc=this.cb=0;this.Ta=new S;this.Ua=new S;this.Va=new S;this.nd=this.Ba=r;this.qb=0;this.v=q;this.Ia=n;this.Ob=Infinity;this.Nb=-Infinity;Ca(this,new Qc);Ca(this,new sd);x(a)&&this.Pb(a)}D(W,S);
W.prototype.Pb=function(a){window.console.log(a);this.i=a.i.slice();this.T=a.T.slice();this.I=a.I.slice();this.cb=a.cb;this.pc=a.pc;this.eb=a.eb;this.qc=a.qc;this.fb=a.fb;this.rc=a.rc;this.Ta=new S(a.Ta);this.Ua=new S(a.Ua);this.Va=new S(a.Va);this.Ba=a.Ba;this.nd=a.nd;this.qb=a.qb;this.v=a.v;this.Ia=a.Ia;W.h.Pb.call(this,a)};
W.prototype.Gc=function(){this.e.length=0;this.Ta.e.length=0;this.Ua.e.length=0;this.Va.e.length=0;this.e.push(this.Ta);this.e.push(this.Ua);this.e.push(this.Va);for(var a=0,a=0;3>a;a++){for(var b=(this.T[a]-1)/2,c=b,d=0,d=0;d<this.T[a];d++){var e=-b*this.I[a]+d*this.I[a],f=[[this.i[0]+e,this.i[1],this.i[2]],[this.i[0],this.i[1]+e,this.i[2]],[this.i[0],this.i[1],this.i[2]+e]],e=this.e[a].e,g=0,h=0,j=[1,1,1],l=this.Ia;0==a?(g=this.T[2]*this.I[2]-this.I[2],h=this.T[1]*this.I[1]-this.I[1],j=[1,1,0]):
1==a?(g=this.T[0]*this.I[0]-this.I[0],h=this.T[2]*this.I[2]-this.I[2],j=[1,0,0]):2==a&&(g=this.T[0]*this.I[0]-this.I[0],h=this.T[1]*this.I[1]-this.I[1],j=[0,1,0]);x(this.Xa)&&(l=r);var m=new re,p=m,f=f[a],t=[[1,0,0],[0,1,0],[0,0,1]][a],o=[[0,1,0],[0,0,-1],[0,1,0]][a];(!x(f)||!(f instanceof Array)||3!=f.length)&&i(Error("Invalid center."));(!x(t)||!(t instanceof Array)||3!=t.length)&&i(Error("Invalid front direction."));(!x(o)||!(o instanceof Array)||3!=o.length)&&i(Error("Invalid up direction."));
y(g)||i(Error("Invalid width."));y(h)||i(Error("Invalid height."));var w=r;x(l)&&(w=l);l=[1,1,1];x(j)&&(l=j);p.i=f;p.ac=t;p.C=o;p.D=g;p.A=h;p.Ia=w;p.Xb=l;p.Gc();m.Xa=this;m.visible=d==Math.floor(c);e.push(m)}0==a?this.pc=this.cb=c:1==a?this.qc=this.eb=c:2==a&&(this.rc=this.fb=c)}this.d=n};
W.prototype.B=function(a){a="undefined"!==typeof a?a:n;if(0<this.e.length)if(this.Ba!=this.nd&&(this.Ba?(this.e[0].e[parseInt(this.cb,10)].visible=r,this.e[1].e[parseInt(this.eb,10)].visible=r,this.e[2].e[parseInt(this.fb,10)].visible=r):this.e[this.qb].visible=r,this.d=n,this.nd=this.Ba),this.Ba)se(this,this.qb);else for(var b=0,b=0;3>b;b++){var c=this.e[b],d=0,e=0;0==b?(d=this.cb,e=this.pc,this.pc=this.cb):1==b?(d=this.eb,e=this.qc,this.qc=this.eb):2==b&&(d=this.fb,e=this.rc,this.rc=this.fb);c.e[parseInt(e,
10)].visible=r;c=c.e[parseInt(d,10)];c.visible=n;c.O=1}a&&W.h.B.call(this)};W.prototype.__defineGetter__("dimensions",s("T"));W.prototype.__defineGetter__("volumeRendering",s("Ba"));W.prototype.__defineSetter__("volumeRendering",function(a){this.Ba=a;this.B(r)});W.prototype.__defineSetter__("visible",ca("Aa"));W.prototype.__defineGetter__("center",s("i"));W.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center."));this.i=a});
W.prototype.__defineGetter__("image",s("Ab"));W.prototype.__defineGetter__("labelmap",function(){this.v||(this.v=new te(this));return this.v});W.prototype.__defineGetter__("indexX",s("cb"));W.prototype.__defineSetter__("indexX",function(a){y(a)&&0<=a&&a<this.Ta.e.length&&(this.cb=a,this.B(r))});W.prototype.__defineGetter__("indexY",s("eb"));W.prototype.__defineSetter__("indexY",function(a){y(a)&&0<=a&&a<this.Ua.e.length&&(this.eb=a,this.B(r))});W.prototype.__defineGetter__("indexZ",s("fb"));
W.prototype.__defineSetter__("indexZ",function(a){y(a)&&0<=a&&a<this.Va.e.length&&(this.fb=a,this.B(r))});W.prototype.__defineGetter__("windowLow",s("Ob"));W.prototype.__defineSetter__("windowLow",ca("Ob"));W.prototype.__defineGetter__("windowHigh",s("Nb"));W.prototype.__defineSetter__("windowHigh",ca("Nb"));W.prototype.__defineGetter__("borders",s("Ia"));W.prototype.__defineSetter__("borders",ca("Ia"));
function se(a,b){if(a.Ba&&(a.d||b!=a.qb)){var c=a.e[a.qb];c.visible=r;var c=a.e[b],d=c.e.length,e;for(e=0;e<d;e++)c.e[e].Aa=n;a.qb=b;a.d=r}}B("X.volume",W);B("X.volume.prototype.modified",W.prototype.B);function ue(){T.call(this);this.c="parserSTL"}D(ue,T);
ue.prototype.parse=function(a,b,c){G.sa(this.c+".parse");this.ha=c;var d=b.k,e=b.m;if("solid"==String.fromCharCode.apply(q,U(this,"uchar",5))){var c=U(this,"uchar",c.byteLength-5),f=c.length,g=r,h=r,j=0,l;for(l=0;l<f;l++)if(10==c[l]){if(g||h){var m=String.fromCharCode.apply(q,c.subarray(j,l)).split(" "),h=parseFloat(m[0]),p=parseFloat(m[1]),m=parseFloat(m[2]);g?(e.add(h,p,m),e.add(h,p,m),e.add(h,p,m)):d.add(h,p,m);h=g=r}}else 32==c[l-1]&&(102==c[l]?(j=l+=13,g=n):118==c[l]&&(j=l+=7,h=n))}else{this.ya=
80;c=U(this,"uint");for(f=f=0;f<c;f++)g=U(this,"float",12),j=g[0],l=g[1],h=g[2],e.add(j,l,h),e.add(j,l,h),e.add(j,l,h),d.add(g[3],g[4],g[5]),d.add(g[6],g[7],g[8]),d.add(g[9],g[10],g[11]),this.ya+=2}G.ga(this.c+".parse");d=new ud;d.Z=b;d.p=a;this.dispatchEvent(d)};B("X.parserSTL",ue);B("X.parserSTL.prototype.parse",ue.prototype.parse);function ve(){T.call(this);this.c="parserVTK"}D(ve,T);
ve.prototype.parse=function(a,b,c){G.sa(this.c+".parse");for(var d=b.k,e=b.m,c=new Uint8Array(c),f="",g=0,h=c.length;g<h;g+=32768)f+=String.fromCharCode.apply(q,c.subarray(g,Math.min(g+32768,h)));var h=f.split("\n"),j=h.length,c=new P,f=new P;this.yb=[];this.ia=rd;this.Yd=this.lb=this.bb=this.mb=r;for(var g=0,l=j%8;l--;)we(this,c,f,h[g]),g++;for(l=0.125*j^0;l--;)we(this,c,f,h[g]),g++,we(this,c,f,h[g]),g++,we(this,c,f,h[g]),g++,we(this,c,f,h[g]),g++,we(this,c,f,h[g]),g++,we(this,c,f,h[g]),g++,we(this,
c,f,h[g]),g++,we(this,c,f,h[g]),g++;g=f.length;j=h=this.yb.length;do{var l=this.yb[h-j],m=l.length,p;for(p=0;p<m&&!("LINES"==this.ia&&p+1>=m);p++){var t=parseInt(l[p],10),o=c.get(t);d.add(o[0],o[1],o[2]);var w=t,v=o;"LINES"==this.ia?(w=parseInt(l[p+1],10),v=c.get(w),d.add(v[0],v[1],v[2])):"TRIANGLE_STRIPS"==this.ia&&(0==p||p==m-1)&&d.add(o[0],o[1],o[2]);t<g?(v=f.get(t),e.add(v[0],v[1],v[2]),"LINES"==this.ia?(w=f.get(w),e.add(w[0],w[1],w[2])):"TRIANGLE_STRIPS"==this.ia&&(0==p||p==m-1)&&e.add(v[0],
v[1],v[2])):(w=new L(o[0],o[1],o[2]),w.normalize(),e.add(w.x,w.y,w.b),"LINES"==this.ia?(w=new L(v[0],v[1],v[2]),w.normalize(),e.add(w.x,w.y,w.b)):"TRIANGLE_STRIPS"==this.ia&&(0==p||p==m-1)&&e.add(w.x,w.y,w.b))}j--}while(0<j);b.ka=this.ia;G.ga(this.c+".parse");d=new ud;d.Z=b;d.p=a;this.dispatchEvent(d)};
function we(a,b,c,d){var d=d.replace(/^\s+|\s+$/g,""),d=d.split(" "),e=d.length,f=d[0];switch(f){case "POINTS":a.mb=n;a.bb=r;a.lb=r;return;case "VERTICES":a.bb=n;a.mb=r;a.lb=r;b=parseInt(d[1],10);3<=b?a.ia=rd:1==b?a.ia="POINTS":i(Error("This VTK file is not supported!"));a.yb=[];return;case "TRIANGLE_STRIPS":a.bb=n;a.mb=r;a.lb=r;a.ia="TRIANGLE_STRIPS";a.yb=[];return;case "LINES":a.bb=n;a.mb=r;a.lb=r;a.ia="LINES";a.yb=[];return;case "POLYGONS":a.bb=n;a.mb=r;a.lb=r;a.ia="POLYGONS";a.yb=[];return;case "POINT_DATA":a.lb=
n;a.mb=r;a.bb=r;return}if(a.mb)if(1==e||isNaN(parseFloat(f)))a.mb=r;else{if(3<=e){var a=parseFloat(d[0]),f=parseFloat(d[1]),g=parseFloat(d[2]);b.add(a,f,g)}6<=e&&(a=parseFloat(d[3]),f=parseFloat(d[4]),g=parseFloat(d[5]),b.add(a,f,g));9<=e&&(e=parseFloat(d[6]),a=parseFloat(d[7]),d=parseFloat(d[8]),b.add(e,a,d))}else a.bb?1==e||isNaN(parseFloat(f))?a.bb=r:a.yb.push(d.slice(1)):a.lb&&("NORMALS"==f?a.Yd=n:1==e||isNaN(parseFloat(f))?(a.lb=r,a.Yd=r):a.Yd&&(3<=e&&(a=parseFloat(d[0]),f=parseFloat(d[1]),g=
parseFloat(d[2]),c.add(a,f,g)),6<=e&&(a=parseFloat(d[3]),f=parseFloat(d[4]),g=parseFloat(d[5]),c.add(a,f,g)),9<=e&&(e=parseFloat(d[6]),a=parseFloat(d[7]),d=parseFloat(d[8]),c.add(e,a,d))))}B("X.parserVTK",ve);B("X.parserVTK.prototype.parse",ve.prototype.parse);function xe(){T.call(this);this.c="parserFSM";this.cd=r}D(xe,T);
xe.prototype.parse=function(a,b,c){G.sa(this.c+".parse");this.ha=c;var d=b.k,c=b.m,e=b.Ac,f=0,g;do g=U(this,"uchar"),f++;while(200>f&&10!=g);U(this,"uchar");var h=U(this,"uint"),f=U(this,"uint"),j=U(this,"float",3*h);g=U(this,"uint",3*f);var h=new Uint32Array(h),l=new Float32Array(9*f),m;for(m=0;m<f;m++){var p=3*m,t=g[p],o=g[p+1],w=g[p+2];e.push(t);e.push(o);e.push(w);h[t]+=1;h[o]+=1;h[w]+=1;var p=3*t,v=3*o,z=3*w,A=j[p],E=j[p+1],F=j[p+2],o=j[v],w=j[v+1],t=j[v+2],C=j[z],J=j[z+1],M=j[z+2];d.add(A,E,
F);d.add(o,w,t);d.add(C,J,M);A=new L(A,E,F);C=new L(C,J,M);o=(new L(o,w,t)).f().Za(A);w=C.f().Za(A);o=Wc(o,w).normalize();l[p]+=o.x;l[p+1]+=o.y;l[p+2]+=o.b;l[v]+=o.x;l[v+1]+=o.y;l[v+2]+=o.b;l[z]+=o.x;l[z+1]+=o.y;l[z+2]+=o.b}for(m=0;m<f;m++)p=3*m,t=g[p],o=g[p+1],w=g[p+2],p=3*t,v=3*o,z=3*w,d=new L(l[v],l[v+1],l[v+2]),e=new L(l[z],l[z+1],l[z+2]),j=(new L(l[p],l[p+1],l[p+2])).scale(1/h[t]).normalize(),d=d.scale(1/h[o]).normalize(),e=e.scale(1/h[w]).normalize(),c.add(j.x,j.y,j.b),c.add(d.x,d.y,d.b),c.add(e.x,
e.y,e.b);b.ka=rd;G.ga(this.c+".parse");c=new ud;c.Z=b;c.p=a;this.dispatchEvent(c)};B("X.parserFSM",xe);B("X.parserFSM.prototype.parse",xe.prototype.parse);function ye(a){function b(){zc+=8;return pa<da.length?da[pa++]:-1}function c(){var a;zc++;a=Ga&1;Ga>>=1;0==Ga&&(Ga=b(),a=Ga&1,Ga=Ga>>1|128);return a}function d(a){for(var b=0,d=a;d--;)b=b<<1|c();a&&(b=M[b]>>8-a);return b}function e(a){E[F++]=a;if(J==w-1){var b=new Uint8Array(2*w);b.set(o);o=b;w*=2}o[J++]=a;32768==F&&(F=0)}function f(){this.rd=this.qd=0;this.ye=q}function g(){for(;;){if(ib[Aa]>=cd)return-1;if(dd[ib[Aa]]==Aa)return ib[Aa]++;ib[Aa]++}}function h(){var a=Ac[Db],b;if(17==Aa)return-1;Db++;
Aa++;b=g();if(0<=b)a.qd=b;else if(a.qd=32768,h())return-1;b=g();if(0<=b)a.rd=b,a.ye=q;else if(a.rd=32768,a.ye=Ac[Db],a.gj=Db,h())return-1;Aa--;return 0}function j(a,b,c){Ac=a;Db=0;dd=c;cd=b;for(a=0;17>a;a++)ib[a]=0;Aa=0;return h()?-1:0}function l(a){for(var b,d,e=0,f=a[e];;)if(b=c()){if(!(f.rd&32768))return f.rd;f=f.ye;b=a.length;for(d=0;d<b;d++)if(a[d]===f){e=d;break}}else{if(!(f.qd&32768))return f.qd;e++;f=a[e]}}function m(){var a,g,h,m,o;do if(a=c(),h=d(2),0==h){Ga=1;h=b();h|=b()<<8;for(b(),b();h--;)g=
b(),e(g)}else if(1==h)for(;;)if(h=M[d(7)]>>1,23<h?(h=h<<1|c(),199<h?(h-=128,h=h<<1|c()):(h-=48,143<h&&(h+=136))):h+=256,256>h)e(h);else if(256==h)break;else{var p;h-=257;o=d(ka[h])+Z[h];h=M[d(5)]>>3;8<$[h]?(p=d(8),p|=d($[h]-8)<<8):p=d($[h]);p+=aa[h];for(h=0;h<o;h++)g=E[F-p&32767],e(g)}else if(2==h){var t=Array(320);g=257+d(5);p=1+d(5);m=4+d(4);for(h=0;19>h;h++)t[h]=0;for(h=0;h<m;h++)t[ua[h]]=d(3);o=jb.length;for(m=0;m<o;m++)jb[m]=new f;if(j(jb,19,t)){F=0;return}o=g+p;m=0;for(var v=-1;m<o;)if(v++,
h=l(jb),16>h)t[m++]=h;else if(16==h){var w;h=3+d(2);if(m+h>o){F=0;return}for(w=m?t[m-1]:0;h--;)t[m++]=w}else{h=17==h?3+d(3):11+d(7);if(m+h>o){F=0;return}for(;h--;)t[m++]=0}o=Fb.length;for(m=0;m<o;m++)Fb[m]=new f;if(j(Fb,g,t)){F=0;return}o=Fb.length;for(m=0;m<o;m++)jb[m]=new f;h=[];for(m=g;m<t.length;m++)h[m-g]=t[m];if(j(jb,p,h)){F=0;return}for(;;)if(h=l(Fb),256<=h){h-=256;if(0==h)break;h--;o=d(ka[h])+Z[h];h=l(jb);8<$[h]?(p=d(8),p|=d($[h]-8)<<8):p=d($[h]);for(p+=aa[h];o--;)g=E[F-p&32767],e(g)}else e(h)}while(!a);
F=0;Ga=1}function p(){var a=[],c;v&8&&(a[0]=b(),a[1]=b(),a[2]=b(),a[3]=b(),80==a[0]&&75==a[1]&&7==a[2]&&8==a[3]&&(b(),b(),b(),b()),b(),b(),b(),b(),b(),b(),b(),b());C&&t(da.byteLength);a[0]=b();if(8==a[0]){v=b();b();b();b();b();b();b();if(v&4){a[0]=b();a[2]=b();Aa=a[0]+256*a[1];for(a=0;a<Aa;a++)b()}if(v&8){a=0;for(pb=[];c=b();){if("7"==c||":"==c)a=0;a<ed-1&&(pb[a++]=c)}}if(v&16)for(;b(););v&2&&(b(),b());m();b();b();b();b();b();b();b();b();C&&t(da.byteLength)}}function t(a){w=a;o=new Uint8Array(a);
a=[];C=r;a[0]=b();a[1]=b();120==a[0]&&218==a[1]&&(m(),A[z]=Array(2),A[z][0]=o,A[z][1]="geonext.gxt",z++);31==a[0]&&139==a[1]&&(p(),A[z]=Array(2),A[z][0]=o,A[z][1]="file",z++);if(80==a[0]&&75==a[1]&&(C=n,a[2]=b(),a[3]=b(),3==a[2]&&4==a[3])){a[0]=b();a[1]=b();v=b();v|=b()<<8;a=b();a|=b()<<8;b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();b();var c=b(),c=c|b()<<8,d=b(),d=d|b()<<8,e=0;for(pb=[];c--;){var f=b();"/"==f|":"==f?e=0:e<ed-1&&(pb[e++]=String.fromCharCode(f))}fd||(fd=pb);for(e=0;e<
d;)b(),e++;J=0;8==a&&(m(),A[z]=Array(2),A[z][0]=o,A[z][1]=pb.join(""),z++);p()}}var o=q,w=0,v,z=0,A=[],E=Array(32768),F=0,C=r,J=0,M=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,
22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,
175,111,239,31,159,95,223,63,191,127,255],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ka=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],aa=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],ua=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],da=a,pa=0,Ga=1,zc=0,ed=256,pb=[],fd,Fb=Array(288),jb=Array(32),
Db=0,Ac=q,Aa=0,ib=Array(17);ib[0]=0;var dd,cd;ye.prototype.We=function(){t(da.byteLength);return o}};function ze(){T.call(this);this.c="parserMGZ";this.cd=r}D(ze,T);ze.prototype.parse=function(a,b,c,d){G.sa(this.c+".parse");var e=c;d&&(e=(new ye(new Uint8Array(c))).We(),e=e.buffer);c=this.Ne(e);b.T=[c.Ce,c.De,c.Ee];b.I=c.kg;d=c.min;e=c.max;b.Ja=b.Ob=d;b.za=b.Nb=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.da&&(b.da=e);b.Gc();G.ga(this.c+".parse");b.Ab=Rd(this,b,c);c=new ud;c.Z=b;c.p=a;this.dispatchEvent(c)};
ze.prototype.Ne=function(a){this.ha=a;a={version:0,rg:0,pg:0,Sg:0,qg:0,Ce:0,De:0,Ee:0,nh:0,type:0,Lg:0,bg:0,wi:q,og:q,kg:q,data:q,min:Infinity,max:-Infinity};a.version=U(this,"uint");a.Ce=U(this,"uint");a.De=U(this,"uint");a.Ee=U(this,"uint");a.nh=U(this,"uint");a.type=U(this,"uint");a.Lg=U(this,"uint");a.bg=U(this,"ushort");if(0<a.bg){a.kg=U(this,"float",3);var b=[];b.push(U(this,"float",3));b.push(U(this,"float",3));b.push(U(this,"float",3));b.push(U(this,"float",3));a.og=b}this.ya=284;b=a.Ce*a.De*
a.Ee;switch(a.type){case 0:a.data=U(this,"uchar",b);break;case 1:a.data=U(this,"uint",b);break;case 3:a.data=U(this,"float",b);break;case 4:a.data=U(this,"ushort",b);break;default:i(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Qd(a.data);a.min=b[0];a.max=b[1];this.ya+16<this.ha.byteLength&&(a.rg=U(this,"float"),a.Sg=U(this,"float"),a.pg=U(this,"float"),a.qg=U(this,"float"));return a};B("X.parserMGZ",ze);B("X.parserMGZ.prototype.parse",ze.prototype.parse);function Ae(){T.call(this);this.c="parserCRV";this.cd=r}D(Ae,T);
Ae.prototype.parse=function(a,b,c){G.sa(this.c+".parse");var d=b.Ac;0==d.length&&i(Error("No _pointIndices defined on the X.object."));this.ha=c;this.ya=3;var e=U(this,"uint");U(this,"uint");U(this,"uint");var f=0,g=0,h=0,j=0,l=0,m=0,p=0,t=0,o=0,w=0,v=0,c=Array(2),z=Array(2),A=U(this,"float",e),E;for(E=0;E<e;E++){var F=A[E];0==E&&(c[0]=z[0]=F);0<=F?(f++,j+=F):(g++,h+=F);o+=F;v++;z[0]=Math.max(F,z[0]);c[0]=Math.min(F,c[0]);A[E]=F}0!=f&&(l=j/f);0!=g&&(m=h/g);0!=v&&(w=o/v);for(v=o=h=j=0;v<e;v++)F=A[v],
E=0,0<=F?(E=Math.pow(F-l,2),j+=E):(E=Math.pow(F-m,2),h+=E),E=Math.pow(F-w,2),o+=E;1<f&&(p=Math.sqrt(j/(f-1)));1<g&&(t=Math.sqrt(h/(g-1)));c[1]=m-2.5*t;z[1]=l+2.5*p;e=d.length;f=new Float32Array(3*e);for(v=0;v<e;v++)g=A[d[v]],h=3*v,f[h]=g,f[h+1]=g,f[h+2]=g;b.q.Ja=c[1];b.q.za=z[1];-Infinity==b.q.ba&&(b.q.ba=c[1]);Infinity==b.q.da&&(b.q.da=z[1]);b.q.r=A;b.q.oc=f;b.q.d=n;G.ga(this.c+".parse");d=new ud;d.Z=b;d.p=a;this.dispatchEvent(d)};B("X.parserCRV",Ae);B("X.parserCRV.prototype.parse",Ae.prototype.parse);function Be(){T.call(this);this.c="parserTRK"}D(Be,T);
Be.prototype.parse=function(a,b,c){G.sa(this.c+".parse");var d=b.k,e=b.m,f=b.xa;this.ha=c;U(this,"uchar",6);U(this,"ushort",3);var g=U(this,"float",3);U(this,"float",3);U(this,"ushort");U(this,"uchar",200);U(this,"ushort");U(this,"uchar",200);U(this,"float",16);U(this,"uchar",444);U(this,"uchar",4);U(this,"uchar",4);U(this,"float",6);U(this,"uchar",2);U(this,"uchar");U(this,"uchar");U(this,"uchar");U(this,"uchar");U(this,"uchar");U(this,"uchar");var h=U(this,"uint");U(this,"uint");var j=U(this,"uint"),
l=[],m=[],c=Infinity,p=-Infinity,t=q,o=q,w=q,v=q,z=q,A=q,E=U(this,"uint",(this.ha.byteLength-1E3)/4);this.ya=j;for(var F=U(this,"float",(this.ha.byteLength-1E3)/4),C=0,J=0,j=0;j<h;j++){for(var M=E[C],Z=new P,ka=0,aa=0;aa<M;aa++){var $=F[C+3*aa+1],ua=F[C+3*aa+2],da=F[C+3*aa+3],$=$/g[0],ua=ua/g[1],da=da/g[2];Z.add($,ua,da);if(0<aa)var pa=Z.get(aa-1),ka=ka+Math.sqrt(Math.pow($-pa[0],2)+Math.pow(ua-pa[1],2)+Math.pow(da-pa[2],2));aa<M-1&&(J+=6)}C+=3*M+1;aa=Z.Gb;M=Z.Db;$=Z.Hb;ua=Z.Eb;da=Z.Ib;pa=Z.Fb;if(!t||
aa<t)t=aa;if(!o||M>o)o=M;if(!w||$<w)w=$;if(!v||ua>v)v=ua;if(!z||da<z)z=da;if(!A||pa>A)A=pa;l.push(Z);m.push(ka)}g=(t+o)/2;w=(w+v)/2;z=(z+A)/2;A=new Float32Array(J);for(j=J=0;j<h;j++){v=l[j];t=v.count;ka=m[j];c=Math.min(c,ka);p=Math.max(p,ka);for(aa=0;aa<t-1;aa++)E=v.get(aa),o=v.get(aa+1),d.add(E[0],E[1],E[2]),d.add(o[0],o[1],o[2]),F=E[0]-g,C=E[1]-w,Z=E[2]-z,M=Math.sqrt(F*F+C*C+Z*Z),$=o[0]-g,ua=o[1]-w,da=o[2]-z,pa=Math.sqrt($*$+ua*ua+da*da),e.add(F/M,C/M,Z/M),e.add($/pa,ua/pa,da/pa),o=[Math.abs(o[0]-
E[0]),Math.abs(o[1]-E[1]),Math.abs(o[2]-E[2])],E=Math.sqrt(o[0]*o[0]+o[1]*o[1]+o[2]*o[2]),o[0]/=E,o[1]/=E,o[2]/=E,f.add(o[0],o[1],o[2]),f.add(o[0],o[1],o[2]),A[J++]=ka,A[J++]=ka,A[J++]=ka,A[J++]=ka,A[J++]=ka,A[J++]=ka}b.ka="LINES";d=new td;d.Ja=c;d.za=p;d.ba=c;d.da=p;d.oc=A;d.mf=r;d.d=n;b.q=d;G.ga(this.c+".parse");d=new ud;d.Z=b;d.p=a;this.dispatchEvent(d)};B("X.parserTRK",Be);B("X.parserTRK.prototype.parse",Be.prototype.parse);function Ce(){T.call(this);this.c="parserIMAGE"}D(Ce,T);Ce.prototype.parse=function(a,b,c,d){c instanceof ArrayBuffer||i(Error());for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=window.btoa(g.join(""));f=new Image;uc(f,"load",this.Fh.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};Ce.prototype.Fh=function(a,b,c){b.Ab=a;a=new ud;a.Z=c;a.p=b;this.dispatchEvent(a)};B("X.parserIMAGE",Ce);B("X.parserIMAGE.prototype.parse",Ce.prototype.parse);function De(){T.call(this);this.c="parserLUT"}D(De,T);
De.prototype.parse=function(a,b,c){G.sa(this.c+".parse");this.ha=c;var c=U(this,"uchar",c.byteLength),d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=String.fromCharCode.apply(q,c.subarray(e,f)),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}G.ga(this.c+".parse");c=new ud;
c.Z=b;c.p=a;this.dispatchEvent(c)};B("X.parserLUT",De);B("X.parserLUT.prototype.parse",De.prototype.parse);function Ee(){T.call(this);this.c="parserNRRD"}D(Ee,T);
Ee.prototype.parse=function(a,b,c){G.sa(this.c+".parse");this.ha=c;var c=U(this,"uchar",c.byteLength),d=c.length,e=q,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=String.fromCharCode.apply(q,c.subarray(0,g-2));f=g+1;break}var h,j,l,m,d=e.split(/\r?\n/);for(e=0,g=d.length;e<g;e++)if(h=d[e],h.match(/NRRD\d+/))this.jh=n;else if(!h.match(/^#/)&&(m=h.match(/(.*):(.*)/)))j=m[1].trim(),h=m[2].trim(),(l=this.Og[j])?l.call(this,h):this[j]=h;this.jh||i(Error("Not an NRRD file"));"raw"!==this.encoding&&"gzip"!==
this.encoding&&"gz"!==this.encoding&&i(Error("Only raw or gz/gzip encoding is allowed"));if(!this.wa&&(this.wa=[new L(1,0,0),new L(0,1,0),new L(0,0,1)],this.Se)){d=[];for(m=0;2>=m;m++)d.push(!isNaN(this.Se[m])?this.wa[m].scale(this.Se[m]):k)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new ye(f)).We();f=f.buffer;c={data:q,min:Infinity,max:-Infinity};c.data=new this.vb(f);m=Qd(c.data);f=c.min=m[0];m=c.max=m[1];b.T=[this.Qe[0],this.Qe[1],this.Qe[2]];b.I=[(new L(this.wa[0][0],this.wa[0][1],
this.wa[0][2])).Ub(),(new L(this.wa[1][0],this.wa[1][1],this.wa[1][2])).Ub(),(new L(this.wa[2][0],this.wa[2][1],this.wa[2][2])).Ub()];b.Ja=b.Ob=f;b.za=b.Nb=m;-Infinity==b.ba&&(b.ba=f);Infinity==b.da&&(b.da=m);b.Gc();G.ga(this.c+".parse");b.Ab=Rd(this,b,c);c=new ud;c.Z=b;c.p=a;this.dispatchEvent(c)};
Ee.prototype.Og={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.vb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.vb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.vb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.vb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.vb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.vb=Uint32Array;break;case "float":this.vb=Float32Array;break;default:i(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.sb=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(parseInt(a,10));return this.Qe=e},"space directions":function(a){var b,
c,d;c=a.match(/\(.*?\)/g);return this.wa=function(){var a,f,g;g=[];for(a=0,f=c.length;a<f;a++)d=c[a],g.push(function(){var a,c,e,f;e=d.slice(1,-1).split(/,/);f=[];for(a=0,c=e.length;a<c;a++)b=e[a],f.push(parseFloat(b));return f}());return g}()},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];for(c=0,d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.Se=e}};B("X.parserNRRD",Ee);B("X.parserNRRD.prototype.parse",Ee.prototype.parse);function Fe(){T.call(this);this.c="parserNII"}D(Fe,T);Fe.prototype.parse=function(a,b,c){G.sa(this.c+".parse");var d=c;348!=(new Uint32Array(c,0,1))[0]&&(d=(new ye(new Uint8Array(c))).We(),d=d.buffer);c=this.Ne(d);b.T=[c.sb[1],c.sb[2],c.sb[3]];b.I=[c.Fd[1],c.Fd[2],c.Fd[3]];var d=c.min,e=c.max;b.Ja=b.Ob=d;b.za=b.Nb=e;-Infinity==b.ba&&(b.ba=d);Infinity==b.da&&(b.da=e);b.Gc();G.ga(this.c+".parse");b.Ab=Rd(this,b,c);c=new ud;c.Z=b;c.p=a;this.dispatchEvent(c)};
Fe.prototype.Ne=function(a){this.ha=a;a={ai:0,Fg:q,Gg:q,Ng:0,Vh:0,Oh:0,Jg:q,sb:q,eh:0,fh:0,gh:0,bh:0,pe:0,Bg:0,ei:0,Fd:q,lg:0,Uh:0,Th:0,di:0,bi:q,si:q,Cg:0,Dg:0,ci:0,li:0,Ug:0,Vg:0,Ig:q,Ag:q,Hh:0,Zh:0,Lh:0,Mh:0,Nh:0,Ih:0,Jh:0,Kh:0,fi:q,gi:q,hi:q,dh:q,kh:q,data:q,min:Infinity,max:-Infinity};a.ai=U(this,"uint");a.Fg=U(this,"uchar",10);a.Gg=U(this,"uchar",18);a.Ng=U(this,"uint");a.Vh=U(this,"ushort");a.Oh=U(this,"uchar");a.Jg=U(this,"uchar");a.sb=U(this,"ushort",8);a.eh=U(this,"float");a.fh=U(this,"float");
a.gh=U(this,"float");a.bh=U(this,"ushort");a.pe=U(this,"ushort");a.Bg=U(this,"ushort");a.ei=U(this,"ushort");a.Fd=U(this,"float",8);a.lg=U(this,"float");a.Uh=U(this,"float");a.Th=U(this,"float");a.di=U(this,"ushort");a.bi=U(this,"uchar");a.si=U(this,"uchar");a.Cg=U(this,"float");a.Dg=U(this,"float");a.ci=U(this,"float");a.li=U(this,"float");a.Ug=U(this,"uint",1);a.Vg=U(this,"uint",1);a.Ig=U(this,"uchar",80);a.Ag=U(this,"uchar",24);a.Hh=U(this,"ushort");a.Zh=U(this,"ushort");a.Lh=U(this,"float");a.Mh=
U(this,"float");a.Nh=U(this,"float");a.Ih=U(this,"float");a.Jh=U(this,"float");a.Kh=U(this,"float");a.fi=U(this,"float",4);a.gi=U(this,"float",4);a.hi=U(this,"float",4);a.dh=U(this,"uchar",16);a.kh=U(this,"uchar",4);this.ya=parseInt(a.lg,10);var b=a.sb[1]*a.sb[2]*a.sb[3];switch(a.pe){case 2:a.data=U(this,"uchar",b);break;case 4:a.data=U(this,"sshort",b);break;case 8:a.data=U(this,"sint",b);break;case 16:a.data=U(this,"float",b);break;case 256:a.data=U(this,"schar",b);break;case 512:a.data=U(this,
"ushort",b);break;case 768:a.data=U(this,"uint",b);break;default:i(Error("Unsupported NII data type: "+a.pe))}b=Qd(a.data);a.min=b[0];a.max=b[1];return a};B("X.parserNII",Fe);B("X.parserNII.prototype.parse",Fe.prototype.parse);function Ge(){K.call(this);this.c="loader";this.sc=new Qb;this.Cc=0}D(Ge,K);function He(a,b){a.Cc+=b/a.sc.la()/3;a.Cc=Math.min(1,a.Cc);var c=new Pd;c.nf=a.Cc;a.dispatchEvent(c)}function Ie(a){var a=a.t.$d,b=a.split(".").pop().toUpperCase();b in Je||i(Error("The "+b+" file format is not supported."));return[a,b,Je[b][0],Je[b][1],Je[b][2]]}
Ge.prototype.load=function(a,b){(!a||!b)&&i(Error("No container or object to load."));if(!Sb(this.sc.w,a.ta)){this.sc.set(a.ta,r);var c=Ie(a)[0];if(a.ad!=q)this.parse(q,a,b);else{var d=new XMLHttpRequest;I(d,"abort",this.zf.bind(this,d,a,b));I(d,"error",this.zf.bind(this,d,a,b));I(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,n);d.responseType="arraybuffer";d.send(q)}}};
Ge.prototype.parse=function(a,b,c){He(this,1);setTimeout(function(){var d=Ie(b),e=d[3],d=new d[2];uc(d,Cc,this.complete.bind(this));var f=b.ad;f==q&&(f=a.response);d.parse(b,c,f,e)}.bind(this),100)};Ge.prototype.complete=function(a){He(this,1);setTimeout(function(){var b=a.p,c=a.Z;b.t.d=r;c.B();this.sc.set(b.ta,n)}.bind(this),100)};Ge.prototype.zf=function(a,b,c){i(Error("Loading failed: ",b,c))};
var Je={STL:[ue,q],VTK:[ve,q],TRK:[Be,q],FSM:[xe,q],INFLATED:[xe,q],SMOOTHWM:[xe,q],SPHERE:[xe,q],PIAL:[xe,q],ORIG:[xe,q],NRRD:[Ee,q],NII:[Fe,q],GZ:[Fe,q],CRV:[Ae,q],LABEL:[Sd,q],MGH:[ze,r],MGZ:[ze,n],TXT:[De,q],LUT:[De,q],PNG:[Ce,"png"],JPG:[Ce,"jpeg"],JPEG:[Ce,"jpeg"],GIF:[Ce,"gif"]};function Ke(a,b){(!y(a)||!y(b))&&i(Error("A camera needs valid width and height values."));K.call(this);this.c="camera";this.ja=new L(0,0,100);this.$b=new L(0,0,0);this.C=new L(0,1,0);this.j=this.Dd(this.ja,this.$b);this.zb=new Float32Array(this.j.K())}D(Ke,K);Ke.prototype.He=function(a){(!x(a)||!(a instanceof V))&&i(Error("Could not observe the interactor."));I(a,Ad,this.zh.bind(this));I(a,Cd,this.Eh.bind(this))};
Ke.prototype.Eh=function(a){a instanceof Kd||i(Error("Received no valid zoom event."));a.Bb?this.mg(a.ab):this.ng(a.ab)};Ke.prototype.zh=function(a){a instanceof Id||i(Error("Received no valid pan event."));this.Yf(a.N)};Ke.prototype.__defineGetter__("view",s("j"));Ke.prototype.__defineSetter__("view",function(a){(!x(a)||!(a instanceof O))&&i(Error("Invalid view matrix."));this.j=a;this.zb=new Float32Array(this.j.K())});
Ke.prototype.__defineGetter__("position",function(){return[this.ja.x,this.ja.y,this.ja.b]});Ke.prototype.__defineSetter__("position",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid position."));this.ja=new L(a[0],a[1],a[2]);this.reset()});Ke.prototype.__defineGetter__("focus",function(){return[this.$b.x,this.$b.y,this.$b.b]});
Ke.prototype.__defineSetter__("focus",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid focus"));this.$b=new L(a[0],a[1],a[2]);this.reset()});Ke.prototype.__defineGetter__("up",function(){return[this.C.x,this.C.y,this.C.b]});Ke.prototype.__defineSetter__("up",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid up vector."));this.C=new L(a[0],a[1],a[2]);this.reset()});u=Ke.prototype;u.reset=function(){this.j=this.Dd(this.ja,this.$b);this.zb=new Float32Array(this.j.K())};
u.Yf=function(a){a instanceof Array&&2==a.length?a=new Zc(a[0],a[1]):a instanceof Zc||i(Error("Invalid distance vector for pan operation."));a=new L(-a.x,a.y,0);a=md(4).translate(a);this.j=new O(a.multiply(this.j));this.zb=new Float32Array(this.j.K())};u.mg=function(a){var b=20;x(a)&&!a&&(b=1);a=new L(0,0,b);a=md(4).translate(a);this.j=new O(a.multiply(this.j));this.zb=new Float32Array(this.j.K())};
u.ng=function(a){var b=30;x(a)&&!a&&(b=1);a=new L(0,0,-b);a=md(4).translate(a);this.j=new O(a.multiply(this.j));this.zb=new Float32Array(this.j.K())};u.Dd=function(a,b){(!(a instanceof L)||!(b instanceof L))&&i(Error("3D vectors required for calculating the view."));return md(4)};B("X.camera",Ke);B("X.camera.prototype.pan",Ke.prototype.Yf);B("X.camera.prototype.zoomIn",Ke.prototype.mg);B("X.camera.prototype.zoomOut",Ke.prototype.ng);function Le(a){function b(a,b,d){b=2*b*Math.PI;b=j.ub(Math.cos(b)).ic(l.ub(Math.sin(b)));a=c.ic(e.ub(a)).ic(b.ub(f));d=b.ub(1-Math.abs(d)).ic(g.ub(d));return new Ic(a,d)}this.u=[];for(var a=a||{},c=new za(a.start||[0,-1,0]),d=new za(a.end||[0,1,0]),e=d.Pc(c),f=a.Na||1,a=a.Re||16,g=e.Vc(),h=0.5<Math.abs(g.y()),j=(new za(h,!h,0)).ne(g).Vc(),l=j.ne(g).Vc(),h=new Ic(c,g.Fe()),d=new Ic(d,g.Vc()),m=[],p=0;p<a;p++){var t=p/a,o=(p+1)/a;m.push(new Kc([h,b(0,t,-1),b(0,o,-1)]));m.push(new Kc([b(0,o,0),b(0,t,
0),b(1,t,0),b(1,o,0)]));m.push(new Kc([d,b(1,o,1),b(1,t,1)]))}return Nc(m)}D(Le,Mc);function Me(){S.call(this);this.c="cylinder";this.ee=[-10,-10,-10];this.Od=[10,10,10];this.Jb=10;this.Kb=32;Ca(this,new wd)}D(Me,S);Me.prototype.__defineGetter__("start",s("ee"));Me.prototype.__defineSetter__("start",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid start"));this.ee=a});Me.prototype.__defineGetter__("end",s("Od"));Me.prototype.__defineSetter__("end",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid end"));this.Od=a});
Me.prototype.__defineGetter__("radius",s("Jb"));Me.prototype.__defineSetter__("radius",function(a){y(a)||i(Error("Invalid radius."));this.Jb=a});Me.prototype.B=function(){yd(this,new Le({start:this.ee,end:this.Od,Na:this.Jb,Re:this.Kb}));Me.h.B.call(this)};B("X.cylinder",Me);B("X.cylinder.prototype.modified",Me.prototype.B);function Ne(a){function b(a,b){var a=a*2*Math.PI,b=b*Math.PI,e=new za(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new Ic(c.ic(e.ub(d)),e))}this.u=[];for(var a=a||{},c=new za(a.je||[0,0,0]),d=a.Na||1,e=a.Re||16,a=a.ii||8,f=[],g=[],h=0;h<e;h++)for(var j=0;j<a;j++)g=[],b(h/e,j/a),0<j&&b((h+1)/e,j/a),j<a-1&&b((h+1)/e,(j+1)/a),b(h/e,(j+1)/a),f.push(new Kc(g));return Nc(f)}D(Ne,Mc);function Oe(){S.call(this);this.c="sphere";this.i=[0,0,0];this.Jb=5;this.Kb=32;this.yg=16;Ca(this,new wd)}D(Oe,S);Oe.prototype.__defineGetter__("center",s("i"));Oe.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.i=a});Oe.prototype.__defineGetter__("radius",s("Jb"));Oe.prototype.__defineSetter__("radius",function(a){y(a)||i(Error("Invalid radius."));this.Jb=a});
Oe.prototype.B=function(){yd(this,new Ne({je:this.i,Na:this.Jb,Re:this.Kb,ii:this.yg}));Oe.h.B.call(this)};B("X.sphere",Oe);B("X.sphere.prototype.modified",Oe.prototype.B);function te(a){W.call(this);this.c="labelmap";this.Xa=a}D(te,W);te.prototype.B=function(){var a=new ud;a.Z=this;this.dispatchEvent(a);this.Xa.B()};B("X.labelmap",te);function Pe(a){this.u=[];var a=a||{},b=new za(a.je||[0,0,0]),c=!a.Na?[1,1,1]:a.Na.length?a.Na:[a.Na,a.Na,a.Na];return Nc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new Kc(a[0].map(function(e){e=new za(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.b()+c[2]*(2*!!(e&4)-1));return new Ic(e,new za(a[1]))}))}))}D(Pe,Mc);function Qe(){S.call(this);this.c="cube";this.i=[0,0,0];this.Ud=this.Td=this.Sd=20;this.Lb=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ca(this,new wd)}D(Qe,S);Qe.prototype.__defineGetter__("center",s("i"));Qe.prototype.__defineSetter__("center",function(a){(!x(a)||!(a instanceof Array)||3!=a.length)&&i(Error("Invalid center"));this.i=a});Qe.prototype.__defineGetter__("lengthX",s("Sd"));
Qe.prototype.__defineSetter__("lengthX",function(a){y(a)||i(Error("Invalid lengthX."));this.Sd=a});Qe.prototype.__defineGetter__("lengthY",s("Td"));Qe.prototype.__defineSetter__("lengthY",function(a){y(a)||i(Error("Invalid lengthY."));this.Td=a});Qe.prototype.__defineGetter__("lengthZ",s("Ud"));Qe.prototype.__defineSetter__("lengthZ",function(a){y(a)||i(Error("Invalid lengthZ."));this.Ud=a});Qe.prototype.B=function(){yd(this,new Pe({je:this.i,Na:[this.Sd/2,this.Td/2,this.Ud/2]}));Qe.h.B.call(this)};
B("X.cube",Qe);B("X.cube.prototype.modified",Qe.prototype.B);function Re(a){V.call(this,a);this.c="interactor3D"}D(Re,V);Re.prototype.Qc=function(a){Re.h.Qc.call(this,a);var b=new Kd;x(a.ec)||(a.ec=0);b.Bb=0>a.ec;b.ab=n;this.dispatchEvent(b)};function Se(a){K.call(this);this.c="array";this.r=[];this.$e=a}D(Se,K);Se.prototype.add=function(a){this.r.push(a);return n};Se.prototype.clear=function(){this.r.length=0};function Te(a,b,c){var d=c-b;if(!(2>d)){d=b+Math.floor(d/2);Te(a,b,d);for(Te(a,d,c);b<d;++b)if(0<a.$e(a.r[b],a.r[d])){var e=a.r[b];a.r[b]=a.r[d];for(var f=a,g=d,h=c;g+1<h&&0>f.$e(f.r[g+1],e);){var j=f,l=g+1,m=j.r[g];j.r[g]=j.r[l];j.r[l]=m;++g}f.r[g]=e}}}Se.prototype.sort=function(){Te(this,0,this.r.length)};function Ue(a,b){Ke.call(this,a,b);this.c="camera2D"}D(Ue,Ke);function Ve(a,b){Ke.call(this,a,b);this.c="camera3D";this.af=45;this.jf=new Float32Array(We(this.af,a/b).K())}D(Ve,Ke);Ve.prototype.He=function(a){Ve.h.He.call(this,a);I(a,Bd,this.Ch.bind(this))};Ve.prototype.Ch=function(a){a instanceof Jd||i(Error("Received no valid rotate event."));this.rotate(a.N)};function We(a,b){var c=1*Math.tan(a*Math.PI/360),d=-c;return new O([[2/(c*b-d*b),0,(c*b+d*b)/(c*b-d*b),0],[0,2/(c-d),(c+d)/(c-d),0],[0,0,-10001/9999,-2.000200020002],[0,0,-1,0]])}
Ve.prototype.rotate=function(a){a instanceof Array&&2==a.length?a=new Zc(a[0],a[1]):a instanceof Zc||i(Error("Invalid distance vector for rotate operation."));var b=-a.x/5*Math.PI/180,a=-a.y/5*Math.PI/180,c=md(4),d=new L(parseFloat(this.j.L(0,0)),parseFloat(this.j.L(0,1)),parseFloat(this.j.L(0,2))),b=c.rotate(b,new L(parseFloat(this.j.L(1,0)),parseFloat(this.j.L(1,1)),parseFloat(this.j.L(1,2)))),a=c.rotate(a,d);this.j=new O(this.j.multiply(a.multiply(b)));this.zb=new Float32Array(this.j.K())};
Ve.prototype.Dd=function(a,b){Ve.h.Dd.call(this,a,b);var c=md(4),d=new L(a.x-b.x,a.y-b.y,a.b-b.b),d=d.normalize(),e=this.C.f();e.Hc(d)&&(e.b+=1.0E-6);var f=Wc(e,d),e=Wc(d,f),f=f.normalize(),e=e.normalize();N(c,0,0,f.x);N(c,0,1,f.y);N(c,0,2,f.b);N(c,0,3,0);N(c,1,0,e.x);N(c,1,1,e.y);N(c,1,2,e.b);N(c,1,3,0);N(c,2,0,d.x);N(c,2,1,d.y);N(c,2,2,d.b);N(c,2,3,0);N(c,3,0,0);N(c,3,1,0);N(c,3,2,0);N(c,3,3,1);d=a.f();return c.translate(d.P())};B("X.camera3D",Ve);B("X.camera3D.prototype.rotate",Ve.prototype.rotate);function Xe(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}Xe.prototype.f=function(){return new Xe(this.top,this.right,this.bottom,this.left)};Xe.prototype.contains=function(a){return!this||!a?r:a instanceof Xe?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};function Ye(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}Ye.prototype.f=function(){return new Ye(this.left,this.top,this.width,this.height)};Ye.prototype.If=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top),a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,n}return r};
Ye.prototype.contains=function(a){return a instanceof Ye?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};Ye.prototype.ma=function(){return new $c(this.width,this.height)};function Ze(a,b){var c=be(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,q))?c[b]||c.getPropertyValue(b):""}function $e(a,b){return a.currentStyle?a.currentStyle[b]:q}function af(a,b){return Ze(a,b)||$e(a,b)||a.style&&a.style[b]}function bf(a){a=a?9==a.nodeType?a:be(a):document;return H&&!qb(9)&&!ne($d(a))?a.body:a.documentElement}
function cf(a){var b=a.getBoundingClientRect();H&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function df(a){if(H&&!qb(8))return a.offsetParent;for(var b=be(a),c=af(a,"position"),d="fixed"==c||"absolute"==c,a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=af(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return q}
function ef(a){for(var b=new Xe(0,Infinity,Infinity,0),c=$d(a),d=c.H.body,e=c.H.documentElement,f=!Ya&&"CSS1Compat"==c.H.compatMode?c.H.documentElement:c.H.body;a=df(a);)if((!H||0!=a.clientWidth)&&(!Ya||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=af(a,"overflow")){var g=ff(a),h;h=a;if(Xa&&!nb("1.9")){var j=parseFloat(Ze(h,"borderLeftWidth"));if(gf(h))var l=h.offsetWidth-h.clientWidth-j-parseFloat(Ze(h,"borderRightWidth")),j=j+l;h=new Xc(j,parseFloat(Ze(h,"borderTopWidth")))}else h=new Xc(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.H.parentWindow||c.H.defaultView||window;e=c.document;Ya&&!nb("500")&&!Za?("undefined"==typeof c.innerHeight&&(c=window),e=c.innerHeight,a=c.document.documentElement.scrollHeight,c==c.top&&a<e&&(e-=15),c=new $c(c.innerWidth,e)):(c="CSS1Compat"==
e.compatMode?e.documentElement:e.body,c=new $c(c.clientWidth,c.clientHeight));b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:q}
function ff(a){var b,c=be(a),d=af(a,"position"),e=Xa&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Xc(0,0),g=bf(c);if(a==g)return f;if(a.getBoundingClientRect)b=cf(a),a=oe($d(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(Ya&&"fixed"==af(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Wa||Ya&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=df(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!Wa||"TR"!=b.tagName)f.y-=b.scrollTop}return f}function hf(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function jf(a){if("none"!=af(a,"display"))return kf(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=kf(a);b.display=c;b.position=e;b.visibility=d;return a}function kf(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ya&&!b&&!c;return(!ha(b)||d)&&a.getBoundingClientRect?(a=cf(a),new $c(a.right-a.left,a.bottom-a.top)):new $c(b,c)}function lf(a,b){a.style.display=b?"":"none"}function gf(a){return"rtl"==af(a,"direction")}
function mf(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}var nf={thin:2,medium:4,thick:6};function of(a,b){if("none"==$e(a,b+"Style"))return 0;var c=$e(a,b+"Width");return c in nf?nf[c]:mf(a,c)};function pf(a){this.Ea=a;this.s=[]}D(pf,Xb);var qf=[];function rf(a,b,c,d,e){ia(c)||(qf[0]=c,c=qf);for(var f=0;f<c.length;f++)a.s.push(I(b,c[f],d||a,e||r,a.Ea||a))}pf.prototype.Hd=function(){yb(this.s,wc);this.s.length=0};pf.prototype.G=function(){pf.h.G.call(this);this.Hd()};pf.prototype.handleEvent=function(){i(Error("EventHandler.handleEvent not implemented"))};function sf(){}(function(a){a.Af=function(){return a.ah||(a.ah=new a)}})(sf);sf.prototype.Ge=0;sf.Af();function tf(a){this.La=a||$d()}D(tf,Hc);u=tf.prototype;u.Zg=sf.Af();u.Hf=q;u.Tb=r;u.n=q;u.hc=q;u.sd=q;u.Fc=q;u.ri=r;u.g=s("n");u.Pe=function(a){this.hc&&this.hc!=a&&i(Error("Method not supported"));tf.h.Pe.call(this,a)};u.wd=s("La");u.dc=function(){this.n=this.La.createElement("div")};u.Wb=function(a){this.tb(a)};u.tb=function(a,b){this.Tb&&i(Error("Component already rendered"));this.n||this.dc();a?a.insertBefore(this.n,b||q):this.La.H.body.appendChild(this.n);(!this.hc||this.hc.Tb)&&this.vd()};
u.vd=function(){this.Tb=n;uf(this,function(a){!a.Tb&&a.g()&&a.vd()})};u.Jc=function(){uf(this,function(a){a.Tb&&a.Jc()});this.Ad&&this.Ad.Hd();this.Tb=r};u.G=function(){tf.h.G.call(this);this.Tb&&this.Jc();this.Ad&&(this.Ad.Da(),delete this.Ad);uf(this,function(a){a.Da()});!this.ri&&this.n&&ke(this.n);this.hc=this.n=this.Fc=this.sd=q};function uf(a,b){a.sd&&yb(a.sd,b,k)}
u.removeChild=function(a,b){if(a){var c=la(a)?a:a.Hf||(a.Hf=":"+(a.Zg.Ge++).toString(36)),a=this.Fc&&c?(c in this.Fc?this.Fc[c]:k)||q:q;if(c&&a){var d=this.Fc;c in d&&delete d[c];Cb(this.sd,a);b&&(a.Jc(),a.n&&ke(a.n));c=a;c==q&&i(Error("Unable to set parent component"));c.hc=q;tf.h.Pe.call(c,q)}}a||i(Error("Child is not in parent component"));return a};function vf(){}D(vf,Hc);u=vf.prototype;u.Xe=0;u.Oc=0;u.Be=100;u.yf=0;u.Te=1;u.ih=r;u.mh=r;u.Kd=function(a){a=wf(this,a);this.Xe!=a&&(this.Xe=a+this.yf>this.Be?this.Be-this.yf:a<this.Oc?this.Oc:a,!this.ih&&!this.mh&&this.dispatchEvent("change"))};u.zd=function(){return wf(this,this.Xe)};u.yd=function(){return wf(this,this.Oc)};u.xd=function(){return wf(this,this.Be)};function wf(a,b){return a.Te==q?b:a.Oc+Math.round((b-a.Oc)/a.Te)*a.Te};function xf(a){this.La=a||$d();this.jc=new vf;I(this.jc,"change",this.Wg,r,this)}D(xf,tf);var yf={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};u=xf.prototype;u.dc=function(){this.Ha=this.wd().dc("div","progress-bar-thumb");var a=yf[this.Xf];this.n=this.wd().dc("div",a,this.Ha);zf(this);this.g().setAttribute("aria-valuemin",this.yd());this.g().setAttribute("aria-valuemax",this.xd())};
u.vd=function(){xf.h.vd.call(this);H&&7>db&&I(this.g(),"resize",this.Md,r,this);this.Md();var a=this.g();a.setAttribute("role","progressbar");a.jj="progressbar";this.g().setAttribute("aria-live","polite")};u.Jc=function(){xf.h.Jc.call(this);Af(this)};function Af(a){H&&7>db&&vc(a.g(),"resize",a.Md,r,a)}u.zd=function(){return this.jc.zd()};u.Kd=function(a){this.jc.Kd(a);this.g()&&zf(this)};function zf(a){var b=a.zd();a.g().setAttribute("aria-valuenow",b)}u.yd=function(){return this.jc.yd()};u.xd=function(){return this.jc.xd()};
u.Xf="horizontal";u.Wg=function(){this.Md();this.dispatchEvent("change")};u.Md=function(){if(this.Ha){var a=this.yd(),b=this.xd(),a=(this.zd()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Xf?H&&7>db?(this.Ha.style.top=0,this.Ha.style.height="100%",b=this.Ha.offsetHeight,a=Math.round(a*b),this.Ha.style.top=b-a+"px",this.Ha.style.height=a+"px"):(this.Ha.style.top=100-b+"%",this.Ha.style.height=b+"%"):this.Ha.style.width=b+"%"}};u.G=function(){Af(this);xf.h.G.call(this);this.Ha=q;this.jc.Da()};function Bf(a,b){x(a)||i(Error("No valid parent element."));x(b)||i(Error("Invalid initial value."));xf.call(this);this.c="progressbar";this.ua=a;this.$c=this.Wa=q;this.xb=[];this.xb=[".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n  background: white;\n  padding: 1px;\n  overflow: hidden;\n  margin: 2px;\n  width: 100px;\n  height: 5px;\n}",".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n  overflow: hidden;\n  width: 0%;\n  height: 100%;\n}",
".progress-bar-thumb-done {\n  background: #57E964;\n}"];this.Kd(b);this.we()}D(Bf,xf);
Bf.prototype.we=function(){if("static"==this.ua.style.position||""==this.ua.style.position)this.ua.style.position="relative";var a=document.getElementsByTagName("head")[0],b=fe("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.xb[0]),d=document.createTextNode(this.xb[1]),e=document.createTextNode(this.xb[2]);a.appendChild(b);b.appendChild(c);b.appendChild(d);b.appendChild(e);this.Wa=b;this.Wb(this.ua);a=this.g();a.style.position="absolute";a.style.top=(this.ua.clientHeight-
5)/2;a.style.left=(this.ua.clientWidth-100)/2;a.classList.add("xtk-progress-bar")};function Cf(a){var b=a.g().style.top,c=a.g().style.left;ke(a.g());var d=new Bf(a.ua,100),e=d.g();e.style.position="absolute";e.style.top=b;e.style.left=c;e.classList.add("xtk-progress-bar");(e.firstElementChild!=k?e.firstElementChild:le(e.firstChild)).classList.add("progress-bar-thumb-done");a.$c=d}Bf.prototype.ze=function(){this.Wa&&ke(this.Wa);this.g()&&ke(this.g());this.$c&&ke(this.$c.g());this.$c=this.Wa=q};var Df=ea.window;function Ef(a,b,c){ma(a)?c&&(a=wa(a,c)):a&&"function"==typeof a.handleEvent?a=wa(a.handleEvent,a):i(Error("Invalid listener argument"));return 2147483647<b?-1:Df.setTimeout(a,b||0)};function Ff(){K.call(this);this.c="renderer";this.p=window.document.body;this.D=this.p.clientWidth;this.A=this.p.clientHeight;this.Cb=this.o=this.X=q;this.Ra=new Se(vd);this.pb=[];this.R=q;this.Zd=this.dd=this.ed=r;this.a=this.Ka=q;this.M={PROGRESSBAR_ENABLED:n};window.console.log("XTK Release 4 -- 04/12/12 -- http://www.goXTK.com")}D(Ff,K);u=Ff.prototype;u.Ah=function(a){this.Ka&&this.Ka.Kd(100*a.nf)};u.qh=function(a){x(a)&&a instanceof ud&&this.Oa(a.Z)};
u.Ke=function(a){(!x(a)||!(a instanceof Md))&&i(Error("Invalid hover event."))};u.Bh=function(){var a=ce(this.p);this.D=a.clientWidth;this.A=a.clientHeight;a=ce(this.X);a.width=this.D;a.height=this.A;this instanceof Gf&&(this.a.viewport(0,0,this.D,this.A),this.o.jf=new Float32Array(We(this.o.af,this.X.width/this.X.height).K()));this.lc()};u.Le=function(a){(!x(a)||!(a instanceof Ld))&&i(Error("Invalid scroll event."))};Ff.prototype.__defineGetter__("config",s("M"));
Ff.prototype.__defineGetter__("interactor",s("Cb"));Ff.prototype.__defineGetter__("camera",s("o"));Ff.prototype.__defineGetter__("loadingCompleted",s("dd"));Ff.prototype.__defineSetter__("loadingCompleted",function(a){this.dd=this.Zd=a});Ff.prototype.__defineGetter__("container",s("p"));
Ff.prototype.__defineSetter__("container",function(a){x(a)||i(Error("An ID to a valid container (<div>..) is required."));var b=a;la(b)&&(b=ce(a));na(b)&&1==b.nodeType||i(Error("Could not find the given container."));this.p=b});u=Ff.prototype;u.lc=function(){this.o.reset()};function Hf(a){a.M.PROGRESSBAR_ENABLED&&a.Ka&&!a.Ze&&(Cf(a.Ka),a.Ze=Ef(function(){this.Ze=q;this.Ka&&(this.Ka.ze(),this.Ka=q);this.Wb()}.bind(a),700))}
u.aa=function(a){var b=fe("canvas");this.p.appendChild(b);this.D=this.p.clientWidth;this.A=this.p.clientHeight;b.width=this.D;b.height=this.A;try{var c=b.getContext(a);c||i(Error())}catch(d){var e="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.p.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+e+"</p>";
i(Error(e))}this.R=new Ge;I(this.R,Fd,this.Ah.bind(this));this.X=b;this.a=c;b=new Re(this.X);"2d"==a&&(b=new qe(this.X));b.aa();I(b,Ed,this.lc.bind(this));I(b,Gd,this.Ke.bind(this));I(b,Dd,this.Le.bind(this));this.Cb=b;b=new Ve(this.D,this.A);"2d"==a&&(b=new Ue(this.D,this.A));b.He(this.Cb);this.o=b;I(window,"resize",this.Bh,r,this)};u.add=function(a){(a instanceof Qe||a instanceof Oe||a instanceof Me)&&a.B();this.pb.push(a);this.Oa(a)};
u.Oa=function(a){(!this.X||!this.a)&&i(Error("The renderer was not initialized properly."));x(a)||(window.console.log(a),i(Error("Illegal object.")));Bc(a)||I(a,Cc,this.qh.bind(this))};u.get=function(a){x(a)||i(Error("Invalid object id."));for(var b=this.Ra.r,c=b.length,d=0,d=0;d<c;d++)if(b[d].ta==a)return b[d];return q};
u.Wb=function(){(!this.X||!this.a)&&i(Error("The renderer was not initialized properly."));x(this.lf)||(this.R.sc.le(r)?(this.M.PROGRESSBAR_ENABLED&&!this.Ka&&(this.Ka=new Bf(this.p,3)),this.lf=Ef(function(){this.lf=q;this.Wb()}.bind(this),100)):(!this.dd&&!this.Zd&&(this.Zd=n,eval("this.onShowtime()"),this.dd=n),this.Ka?Hf(this):(window.Rc(this.Wb.bind(this,this.X)),eval("this.onRender()"),this.tb(r,n))))};u.Wf=ba();u.Uf=ba();u.tb=ba();
u.ud=function(){this.Ra.clear();delete this.Ra;this.pb.length=0;delete this.pb;delete this.R;this.R=q;delete this.o;this.o=q;delete this.Cb;this.Cb=q;delete this.a;this.a=q;ke(this.X);delete this.X;this.X=q};function If(){K.call(this);this.c="shaders";this.md="";this.md="precision mediump float;\n\nattribute vec3 vertexPosition;\nattribute vec3 vertexNormal;\nattribute vec3 vertexColor;\nattribute vec2 vertexTexturePos;\nattribute float vertexScalar;\n\nuniform mat4 view;\nuniform mat4 perspective;\nuniform vec3 center;\nuniform mat4 objectTransform;\nuniform bool useObjectColor;\nuniform bool useScalars;\nuniform bool scalarsReplaceMode;\nuniform float scalarsMin;\nuniform float scalarsMax;\nuniform vec3 scalarsMinColor;\nuniform vec3 scalarsMaxColor;\nuniform float scalarsMinThreshold;\nuniform float scalarsMaxThreshold;\nuniform vec3 objectColor;\nuniform float pointSize;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * vertexNormal;\n  fVertexNormal = vertexNormal;\n  fDiscardNow = 0.0;\n  vec3 vertexPosition2 = vertexPosition - center;\n  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n  fragmentTexturePos = vertexTexturePos;\n  if (useScalars) {\n    float scalarValue = vertexScalar;\n    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n      if (scalarsReplaceMode) {\n        fragmentColor = objectColor;\n      } else {\n        fDiscardNow = 1.0;\n      }\n    } else {\n      if (scalarsReplaceMode) {\n        fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n      } else {\n        fragmentColor = vertexColor;\n      }\n    }\n  } else if (useObjectColor) {\n    fragmentColor = objectColor;\n  } else {\n    fragmentColor = vertexColor;\n  }\n  gl_PointSize = pointSize;\n  gl_Position = perspective * fVertexPosition;\n}\n";
this.bd="";this.bd="precision mediump float;\n\nuniform bool usePicking;\nuniform bool useTexture;\nuniform bool volumeTexture;\nuniform bool useLabelMapTexture;\nuniform sampler2D textureSampler;\nuniform sampler2D textureSampler2;\nuniform float objectOpacity;\nuniform float labelmapOpacity;\nuniform float volumeLowerThreshold;\nuniform float volumeUpperThreshold;\nuniform float volumeScalarMin;\nuniform float volumeScalarMax;\nuniform vec3 volumeScalarMinColor;\nuniform vec3 volumeScalarMaxColor;\nuniform float volumeWindowLow;\nuniform float volumeWindowHigh;\n\nvarying float fDiscardNow;\nvarying vec4 fVertexPosition;\nvarying vec3 fragmentColor;\nvarying vec2 fragmentTexturePos;\nvarying vec3 fVertexNormal;\nvarying vec3 fTransformedVertexNormal;\n\nvoid main(void) {\n if (fDiscardNow > 0.0) {\n   discard;\n }\n if (usePicking) {\n   gl_FragColor = vec4(fragmentColor, 1.0);\n } else if (useTexture) {\n   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n   vec4 textureSum = texture1;\n   if (volumeTexture) {\n     float _windowLow = (volumeWindowLow / volumeScalarMax);\n     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n     vec3 fac = _maxrange - _minrange;\n     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n   }\n   if (useLabelMapTexture) {\n     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n     if (texture2.a > 0.0) {\n       if (labelmapOpacity < 1.0) {\n         textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n       } else {\n         textureSum = texture2;\n       }\n     }\n   }\n   if (volumeTexture) {\n     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n     if (texture1.r < _volumeLowerThreshold ||\n         texture1.r > _volumeUpperThreshold) {\n       discard;\n     };\n   };\n   gl_FragColor = textureSum;\n   gl_FragColor.a = objectOpacity;\n } else {\n   vec3 nNormal = normalize(fTransformedVertexNormal);\n   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n     gl_FragColor = vec4(fragmentColor,1.0);\n     return;\n   }\n   vec3 light = vec3(0.0, 0.0, 1.0);\n   vec3 lightDirection = vec3(0,0,-10);\n   lightDirection = normalize(lightDirection);\n   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n   float ambient = 0.3;\n   gl_FragColor = vec4(fragmentColor * ambient +\n                       fragmentColor * diffuse +\n                       vec3(0.2, 0.2, 0.2) * specular,\n                       objectOpacity);\n }\n}\n"}
D(If,K);
var Jf={Ti:"vertexPosition",Si:"vertexNormal",Ri:"vertexColor",Vi:"vertexTexturePos",Ui:"vertexScalar"},Kf={Wi:"view",Bi:"perspective",ti:"center",Ai:"objectTransform",Ni:"useObjectColor",yi:"objectColor",Pi:"useScalars",Ji:"scalarsReplaceMode",Gi:"scalarsMin",Di:"scalarsMax",Hi:"scalarsMinColor",Ei:"scalarsMaxColor",Ii:"scalarsMinThreshold",Fi:"scalarsMaxThreshold",Ci:"pointSize",zi:"objectOpacity",xi:"normal",Oi:"usePicking",Qi:"useTexture",Mi:"useLabelMapTexture",vi:"labelmapOpacity",Ki:"textureSampler",Li:"textureSampler2",
Xi:"volumeLowerThreshold",cj:"volumeUpperThreshold",$i:"volumeScalarMin",Yi:"volumeScalarMax",aj:"volumeScalarMinColor",Zi:"volumeScalarMaxColor",ej:"volumeWindowLow",dj:"volumeWindowHigh",bj:"volumeTexture"};
function Lf(a){var b=Object.keys(Kf);Object.keys(Jf).every(function(a){a=Jf[a];return-1!=this.md.search(a)||-1!=this.bd.search(a)}.bind(a))||i(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Kf[a];return-1!=this.md.search(a)||-1!=this.bd.search(a)}.bind(a))||i(Error("Could not find all uniforms in the shader sources."))};function Mf(a,b,c){x(a)||i(Error("Invalid GL Buffer."));x(b)||i(Error("Invalid number of items."));x(c)||i(Error("Invalid item size."));K.call(this);this.c="buffer";this.Y=a;this.gb=b;this.hb=c}D(Mf,K);function Nf(a,b,c,d,e,f,g,h){var j,l=c.offsetParent;if(l){var m="HTML"==l.tagName||"BODY"==l.tagName;if(!m||"static"!=af(l,"position"))j=ff(l),m||(j=Yc(j,new Xc(l.scrollLeft,l.scrollTop)))}l=ff(a);m=jf(a);l=new Ye(l.x,l.y,m.width,m.height);(m=ef(a))&&l.If(new Ye(m.left,m.top,m.right-m.left,m.bottom-m.top));var m=$d(a),p=$d(c);if(m.H!=p.H){var t=m.H.body,p=p.H.parentWindow||p.H.defaultView,o=new Xc(0,0),w=be(t)?be(t).parentWindow||be(t).defaultView:window,v=t;do{var z;if(w==p)z=ff(v);else{var A=v;
z=new Xc;if(1==A.nodeType)if(A.getBoundingClientRect)A=cf(A),z.x=A.left,z.y=A.top;else{var E=oe($d(A)),A=ff(A);z.x=A.x-E.x;z.y=A.y-E.y}else{var E=ma(A.Tg),F=A;A.targetTouches?F=A.targetTouches[0]:E&&A.Ma.targetTouches&&(F=A.Ma.targetTouches[0]);z.x=F.clientX;z.y=F.clientY}}o.x+=z.x;o.y+=z.y}while(w&&w!=p&&(v=w.frameElement)&&(w=w.parent));t=Yc(o,ff(t));H&&!ne(m)&&(t=Yc(t,oe(m)));l.left+=t.x;l.top+=t.y}a=(b&4&&gf(a)?b^2:b)&-5;b=new Xc(a&2?l.left+l.width:l.left,a&1?l.top+l.height:l.top);j&&(b=Yc(b,
j));e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var C;if(g&&(C=ef(c))&&j)C.top-=j.y,C.right-=j.x,C.bottom-=j.y,C.left-=j.x;return Of(b,c,d,f,C,g,h)}
function Of(a,b,c,d,e,f,g){var a=a.f(),h=0,j=(c&4&&gf(b)?c^2:c)&-5,c=jf(b),g=g?g.f():c.f();if(d||0!=j)j&2?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),j&1?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f){if(e){h=a;d=0;if(65==(f&65)&&(h.x<e.left||h.x>=e.right))f&=-2;if(132==(f&132)&&(h.y<e.top||h.y>=e.bottom))f&=-5;h.x<e.left&&f&1&&(h.x=e.left,d|=1);h.x<e.left&&h.x+g.width>e.right&&f&16&&(g.width=Math.max(g.width-(h.x+g.width-e.right),0),d|=4);h.x+g.width>e.right&&f&1&&(h.x=Math.max(e.right-g.width,
e.left),d|=1);f&2&&(d|=(h.x<e.left?16:0)|(h.x+g.width>e.right?32:0));h.y<e.top&&f&4&&(h.y=e.top,d|=2);h.y>=e.top&&h.y+g.height>e.bottom&&f&32&&(g.height=Math.max(g.height-(h.y+g.height-e.bottom),0),d|=8);h.y+g.height>e.bottom&&f&4&&(h.y=Math.max(e.bottom-g.height,e.top),d|=2);f&8&&(d|=(h.y<e.top?64:0)|(h.y+g.height>e.bottom?128:0));h=d}else h=256;if(h&496)return h}f=a;e=Xa&&(Pa||cb)&&nb("1.9");f instanceof Xc?(a=f.x,f=f.y):(a=f,f=k);b.style.left=hf(a,e);b.style.top=hf(f,e);ad(c,g)||(a=ne($d(be(b))),
H&&(!a||!nb("8"))?(c=b.style,a?(H?(a=mf(b,$e(b,"paddingLeft")),e=mf(b,$e(b,"paddingRight")),f=mf(b,$e(b,"paddingTop")),d=mf(b,$e(b,"paddingBottom")),a=new Xe(f,e,d,a)):(a=Ze(b,"paddingLeft"),e=Ze(b,"paddingRight"),f=Ze(b,"paddingTop"),d=Ze(b,"paddingBottom"),a=new Xe(parseFloat(f),parseFloat(e),parseFloat(d),parseFloat(a))),H?(e=of(b,"borderLeft"),f=of(b,"borderRight"),d=of(b,"borderTop"),b=of(b,"borderBottom"),b=new Xe(d,f,b,e)):(e=Ze(b,"borderLeftWidth"),f=Ze(b,"borderRightWidth"),d=Ze(b,"borderTopWidth"),
b=Ze(b,"borderBottomWidth"),b=new Xe(parseFloat(d),parseFloat(f),parseFloat(b),parseFloat(e))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,Xa?b.MozBoxSizing="border-box":Ya?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",b.height=Math.max(g.height,0)+"px"));return h};function Pf(){}Pf.prototype.Ga=ba();function Qf(a,b){this.element=a;this.sf=b}D(Qf,Pf);Qf.prototype.Ga=function(a,b,c){Nf(this.element,this.sf,a,b,k,c)};function Rf(a,b){this.Ea=new pf(this);this.Oe(a||q);b&&(this.mc=b)}D(Rf,Hc);u=Rf.prototype;u.n=q;u.zg=n;u.of=q;u.fa=r;u.$h=r;u.Ae=-1;u.Yg=r;u.Mg=n;u.mc="toggle_display";u.g=s("n");u.Oe=function(a){this.fa&&i(Error("Can not change this state of the popup while showing."));this.n=a};
function Sf(a,b){a.Tc&&a.Tc.stop();a.Mc&&a.Mc.stop();if(b){if(!a.fa&&a.Ie()){a.n||i(Error("Caller must call setElement before trying to show the popup"));a.Ga();var c=be(a.n);a.Yg&&rf(a.Ea,c,"keydown",a.oh,n);if(a.zg)if(rf(a.Ea,c,"mousedown",a.Sf,n),H){var d;try{d=c.activeElement}catch(e){}for(;d&&"IFRAME"==d.nodeName;){try{var f=d.contentDocument||d.contentWindow.document}catch(g){break}c=f;d=c.activeElement}rf(a.Ea,c,"mousedown",a.Sf,n);rf(a.Ea,c,"deactivate",a.Rf)}else rf(a.Ea,c,"blur",a.Rf);"toggle_display"==
a.mc?(a.n.style.visibility="visible",lf(a.n,n)):"move_offscreen"==a.mc&&a.Ga();a.fa=n;a.Tc?(uc(a.Tc,"end",a.Vf,r,a),a.Tc.play()):a.Vf()}}else Tf(a)}u.Ga=fa;function Tf(a,b){if(!a.fa||!a.dispatchEvent({type:"beforehide",target:b}))return r;a.Ea&&a.Ea.Hd();a.Mc?(uc(a.Mc,"end",xa(a.rf,b),r,a),a.Mc.play()):a.rf(b);return n}u.rf=function(a){"toggle_display"==this.mc?this.$h?Ef(this.Gf,0,this):this.Gf():"move_offscreen"==this.mc&&(this.n.style.left="-200px",this.n.style.top="-200px");this.fa=r;this.Je(a)};
u.Gf=function(){this.n.style.visibility="hidden";lf(this.n,r)};u.Ie=function(){return this.dispatchEvent("beforeshow")};u.Vf=function(){this.Ae=ya();this.dispatchEvent("show")};u.Je=function(a){ya();this.dispatchEvent({type:"hide",target:a})};u.Sf=function(a){a=a.target;!me(this.n,a)&&(!this.of||me(this.of,a))&&!(150>ya()-this.Ae)&&Tf(this,a)};u.oh=function(a){27==a.keyCode&&Tf(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
u.Rf=function(a){if(this.Mg){var b=be(this.n);if(H||Wa){if(a=b.activeElement,!a||me(this.n,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>ya()-this.Ae||Tf(this)}};u.G=function(){Rf.h.G.call(this);this.Ea.Da();Zb(this.Tc);Zb(this.Mc);delete this.n;delete this.Ea};function Uf(a,b){this.me=a instanceof Xc?a:new Xc(a,b)}D(Uf,Pf);Uf.prototype.Ga=function(a,b,c,d){Nf(bf(a),0,a,b,this.me,c,q,d)};function Vf(a,b){this.Gh=4;this.Gd=b||k;Rf.call(this,a)}D(Vf,Rf);Vf.prototype.Ga=function(){if(this.Gd){var a=!this.fa&&"move_offscreen"!=this.mc,b=this.g();a&&(b.style.visibility="hidden",lf(b,n));this.Gd.Ga(b,this.Gh,this.hj);a&&lf(b,r)}};function Wf(a,b,c){this.La=c||(a?$d(ce(a)):$d());Vf.call(this,this.La.dc("div",{style:"position:absolute;display:none;"}));this.oe=new Xc(1,1);this.Qb=new Ub;a&&Xf(this,a);if(b!=q)if(a=this.g(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(be(a).createTextNode(b))}}D(Wf,Vf);var Yf=[];u=Wf.prototype;u.ea=q;u.className="goog-tooltip";
u.cg=500;u.Xg=0;u.wd=s("La");function Xf(a,b){b=ce(b);a.Qb.add(b);I(b,"mouseover",a.Df,r,a);I(b,"mouseout",a.Bd,r,a);I(b,"mousemove",a.Cf,r,a);I(b,"focus",a.Bf,r,a);I(b,"blur",a.Bd,r,a)}u.detach=function(a){if(a)a=ce(a),Zf(this,a),this.Qb.remove(a);else{for(var b=this.Qb.Sb(),c=0;a=b[c];c++)Zf(this,a);this.Qb.clear()}};function Zf(a,b){vc(b,"mouseover",a.Df,r,a);vc(b,"mouseout",a.Bd,r,a);vc(b,"mousemove",a.Cf,r,a);vc(b,"focus",a.Bf,r,a);vc(b,"blur",a.Bd,r,a)}
u.Oe=function(a){var b=this.g();b&&ke(b);Wf.h.Oe.call(this,a);a&&(b=this.La.H.body,b.insertBefore(a,b.lastChild))};u.Ie=function(){if(!Rf.prototype.Ie.call(this))return r;if(this.anchor)for(var a,b=0;a=Yf[b];b++)me(a.g(),this.anchor)||Sf(a,r);0<=xb(Yf,this)||Yf.push(this);a=this.g();a.className=this.className;$f(this);I(a,"mouseover",this.Ff,r,this);I(a,"mouseout",this.Ef,r,this);ag(this);return n};
u.Je=function(){Cb(Yf,this);for(var a=this.g(),b,c=0;b=Yf[c];c++)b.anchor&&me(a,b.anchor)&&Sf(b,r);this.Zf&&bg(this.Zf);vc(a,"mouseover",this.Ff,r,this);vc(a,"mouseout",this.Ef,r,this);this.anchor=k;if(0==(this.Ya?this.fa?4:1:this.gc?3:this.fa?2:0))this.Id=r;Rf.prototype.Je.call(this)};u.Pf=function(a,b){this.anchor==a&&this.Qb.contains(this.anchor)&&(this.Id||!this.ij?(Sf(this,r),this.fa||(this.anchor=a,this.Gd=b||cg(this,0)||k,this.fa&&this.Ga(),Sf(this,n))):this.anchor=k);this.Ya=k};
u.lh=function(a){this.gc=k;a==this.anchor&&(this.ea==q||this.ea!=this.g()&&!this.Qb.contains(this.ea))&&(!this.pf||!this.pf.ea)&&Sf(this,r)};function dg(a,b){var c=oe(a.La);a.oe.x=b.clientX+c.x;a.oe.y=b.clientY+c.y}u.Df=function(a){var b=eg(this,a.target);this.ea=b;$f(this);b!=this.anchor&&(this.anchor=b,this.Ya||(this.Ya=Ef(wa(this.Pf,this,b,k),this.cg)),fg(this),dg(this,a))};function eg(a,b){try{for(;b&&!a.Qb.contains(b);)b=b.parentNode;return b}catch(c){return q}}
u.Cf=function(a){dg(this,a);this.Id=n};u.Bf=function(a){this.ea=a=eg(this,a.target);this.Id=n;if(this.anchor!=a){this.anchor=a;var b=cg(this,1);$f(this);this.Ya||(this.Ya=Ef(wa(this.Pf,this,a,b),this.cg));fg(this)}};function cg(a,b){if(0==b){var c=a.oe.f();return new gg(c)}return new hg(a.ea)}function fg(a){if(a.anchor)for(var b,c=0;b=Yf[c];c++)me(b.g(),a.anchor)&&(b.pf=a,a.Zf=b)}
u.Bd=function(a){var b=eg(this,a.target),c=eg(this,a.relatedTarget);b!=c&&(b==this.ea&&(this.ea=q),ag(this),this.Id=r,this.fa&&(!a.relatedTarget||!me(this.g(),a.relatedTarget))?bg(this):this.anchor=k)};u.Ff=function(){var a=this.g();this.ea!=a&&($f(this),this.ea=a)};u.Ef=function(a){var b=this.g();if(this.ea==b&&(!a.relatedTarget||!me(b,a.relatedTarget)))this.ea=q,bg(this)};function ag(a){a.Ya&&(Df.clearTimeout(a.Ya),a.Ya=k)}
function bg(a){if(2==(a.Ya?a.fa?4:1:a.gc?3:a.fa?2:0))a.gc=Ef(wa(a.lh,a,a.anchor),a.Xg)}function $f(a){a.gc&&(Df.clearTimeout(a.gc),a.gc=k)}u.G=function(){Sf(this,r);ag(this);this.detach();this.g()&&ke(this.g());this.ea=q;delete this.La;Wf.h.G.call(this)};function gg(a,b){Uf.call(this,a,b)}D(gg,Uf);gg.prototype.Ga=function(a,b,c){b=bf(a);b=ef(b);c=c?new Xe(c.top+10,c.right,c.bottom,c.left+10):new Xe(10,0,0,10);Of(this.me,a,4,c,b,9)&496&&Of(this.me,a,4,c,b,5)};function hg(a){Qf.call(this,a,3)}
D(hg,Qf);hg.prototype.Ga=function(a,b,c){var d=new Xc(10,0);Nf(this.element,this.sf,a,b,d,c,9)&496&&Nf(this.element,2,a,1,d,c,5)};function ig(a,b,c,d){x(a)||i(Error("No valid parent element."));(!y(b)||!y(c))&&i(Error("Invalid coordinates."));(!x(d)||!(d instanceof V))&&i(Error("Invalid interactor."));Wf.call(this);this.c="caption";this.ua=a;this.od=b;this.pd=c;this.Cb=d;this.Wa=q;this.xb=[];this.xb=[".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n  border: 1px solid infotext;\n  padding: 1px;\n  font-family: sans-serif;\n}"];uc(d,Hd,this.ze.bind(this));this.we()}D(ig,Wf);
ig.prototype.we=function(){if("static"==this.ua.style.position||""==this.ua.style.position)this.ua.style.position="relative";var a=document.getElementsByTagName("head")[0],b=fe("style");b.type="text/css";b.media="screen";var c=document.createTextNode(this.xb[0]);a.appendChild(b);b.appendChild(c);this.Wa=b;this.Gd=new Uf(this.od,this.pd)||k;this.fa&&this.Ga();Sf(this,n);Xf(this,this.ua);this.g().classList.add("x-tooltip")};
ig.prototype.ze=function(){Sf(this,r);this.Wa&&ke(this.Wa);this.g()&&ke(this.g());this.Wa=q};function Gf(){Ff.call(this);this.c="renderer3D";this.wc=this.zc=this.vc=this.yc=this.uc=this.xc=this.ae=this.be=q;this.i=[0,0,0];this.kf=q;this.Nd=new Qb;this.Dc=new Qb;this.Ec=new Qb;this.Xd=new Qb;this.Zc=new Qb;this.jd=new Qb;this.kd=new Qb;this.ld=new Qb;this.M={PROGRESSBAR_ENABLED:n,PICKING_ENABLED:n,ORDERING_ENABLED:n,STATISTICS_ENABLED:r}}D(Gf,Ff);Gf.prototype.__defineGetter__("config",s("M"));u=Gf.prototype;u.Ph=function(){this.wc=this.zc=this.vc=this.yc=this.uc=this.xc=q;this.i=[0,0,0]};
u.Ke=function(a){Gf.h.Ke.call(this,a);var b=a.od,a=a.pd,c=this.get(this.$f(b,a));if(c&&(c=c.Yb))(new ig(this.p,this.p.offsetLeft+b+10,this.p.offsetTop+a+10,this.Cb)).g().innerHTML=c};
u.aa=function(){Gf.h.aa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.D,this.A),this.a.clearColor(0,0,0,0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.M.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();this.a.bindTexture(this.a.TEXTURE_2D,
c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.D,this.A,0,this.a.RGB,this.a.UNSIGNED_BYTE,q);this.a.bindFramebuffer(this.a.FRAMEBUFFER,a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.D,this.A);this.a.bindRenderbuffer(this.a.RENDERBUFFER,q);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,
b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.kf=a}}catch(d){i(Error("Exception while accessing GL Context!\n"+d))}jg(this)};
function jg(a){var b=new If;(!x(a.X)||!x(a.a)||!x(a.o))&&i(Error("Renderer was not initialized properly."));(!x(b)||!(b instanceof If))&&i(Error("Could not add shaders."));Lf(b);var c=a.a.createShader(a.a.FRAGMENT_SHADER),d=a.a.createShader(a.a.VERTEX_SHADER);a.a.shaderSource(c,b.bd);a.a.shaderSource(d,b.md);a.a.compileShader(c);a.a.compileShader(d);a.a.getShaderParameter(c,a.a.COMPILE_STATUS)||i(Error("Fragement Shader compilation failed!\n"+a.a.getShaderInfoLog(c)));a.a.getShaderParameter(d,a.a.COMPILE_STATUS)||
i(Error("Vertex Shader compilation failed!\n"+a.a.getShaderInfoLog(d)));var e=a.a.createProgram();a.a.attachShader(e,d);a.a.attachShader(e,c);a.a.linkProgram(e);a.a.getProgramParameter(e,a.a.LINK_STATUS)||i(Error("Could not create shader program!\n"+a.a.getShaderInfoLog(c)+"\n"+a.a.getShaderInfoLog(d)+"\n"+a.a.getProgramInfoLog(e)));a.a.useProgram(e);a.ae=e;Object.keys(Jf).forEach(function(a){a=Jf[a];this.Nd.set(a,this.a.getAttribLocation(this.ae,a));this.a.enableVertexAttribArray(this.Nd.get(a))}.bind(a));
Object.keys(Kf).forEach(function(a){a=Kf[a];this.Dc.set(a,this.a.getUniformLocation(this.ae,a))}.bind(a));a.be=b}
u.Oa=function(a){Gf.h.Oa.call(this,a);var b=r;this.get(a.ta)&&(b=n);var c=a.ta,d=a.k,e=a.m,f=a.xa,g=a.$,h=a.t,j=a.Mb,l=a.Q,m=a.v,p=a.q;if(x(m)&&x(m.t)&&m.t.d)this.Oa(m);else if(x(m)&&m.d&&this.Oa(m),x(l)&&x(l.t)&&l.t.d)this.R.load(l,a);else if(x(g)&&x(g.t)&&g.t.d)this.R.load(g,a);else if(x(h)&&h.d)this.R.load(a,a);else if(x(p)&&x(p.t)&&p.t.d)this.R.load(p,a);else{if(0<a.e.length){h=a.e;l=h.length;for(m=m=0;m<l;m++)this.Oa(h[m])}if(0==d.count)a.d=r;else{for(h=0;this.ed;)h++,window.console.log("Possible thread lock avoided: "+
h);this.ed=n;G.sa(this.c+".update");l=a instanceof re&&a.Xa instanceof te;b&&x(g)&&g.d&&(h=this.kd.get(c),x(h)&&this.a.isBuffer(h.Y)&&this.a.deleteBuffer(h.Y));h=q;x(g)&&(!b||g.d?(h=a.Lb,x(h)||i(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),m=r,g.nb&&(m=n),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,m),m=this.a.createTexture(),m.$g=g.Ab,this.ld.set(g.ta,m),this.a.bindTexture(this.a.TEXTURE_2D,m),g.nb?this.a.texImage2D(this.a.TEXTURE_2D,
0,this.a.RGBA,g.hd,g.gd,0,this.a.RGBA,this.a.UNSIGNED_BYTE,g.nb):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,m.$g),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE),l?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,
this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,q),m=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,m),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),this.a.STATIC_DRAW),h=new Mf(m,h.length,2),g.d=r):h=this.kd.get(c));He(this.R,0.1);if(l)this.ed=r,G.ga(this.c+".update"),He(this.R,0.9);else{if(!b||d.d||j.d){l=j.l;g=l.Fa(new L(d.Gb,d.Hb,d.Ib));l=l.Fa(new L(d.Db,d.Eb,
d.Fb));if(this.xc===q||g.x<this.xc)this.xc=g.x;if(this.uc===q||l.x>this.uc)this.uc=l.x;if(this.yc===q||g.y<this.yc)this.yc=g.y;if(this.vc===q||l.y>this.vc)this.vc=l.y;if(this.zc===q||g.b<this.zc)this.zc=g.b;if(this.wc===q||l.b>this.wc)this.wc=l.b;this.i=[(this.xc+this.uc)/2,(this.yc+this.vc)/2,(this.zc+this.wc)/2];j.d=r}b&&d.d&&(j=this.Ec.get(c),x(j)&&this.a.isBuffer(j.Y)&&this.a.deleteBuffer(j.Y));j=q;!b||d.d?(j=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,j),this.a.bufferData(this.a.ARRAY_BUFFER,
new Float32Array(d.U),this.a.STATIC_DRAW),j=new Mf(j,d.count,3),d.d=r):j=this.Ec.get(c);He(this.R,0.3);b&&e.d&&(g=this.Ec.get(c),x(g)&&this.a.isBuffer(g.Y)&&this.a.deleteBuffer(g.Y));g=q;!b||e.d?(g=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(e.U),this.a.STATIC_DRAW),g=new Mf(g,e.count,3),e.d=r):g=this.Xd.get(c);He(this.R,0.3);b&&f.d&&(e=this.Zc.get(c),x(e)&&this.a.isBuffer(e.Y)&&this.a.deleteBuffer(e.Y));e=q;0<f.length&&(!b||
f.d?(f.length!=d.length&&i(Error("Mismatch between points and point colors.")),e=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(f.U),this.a.STATIC_DRAW),e=new Mf(e,f.count,3),f.d=r):e=this.Zc.get(c));He(this.R,0.2);b&&p&&p.d&&(f=this.jd.get(c),x(f)&&this.a.isBuffer(f.Y)&&this.a.deleteBuffer(f.Y));f=q;p&&(f=p.oc,!b||p.d?(f.length!=d.length&&i(Error("Mismatch between points and scalars.")),d=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,
d),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Mf(d,f.length,3),p.d=r):f=this.jd.get(c));He(this.R,0.1);b||this.Ra.add(a);this.Ec.set(c,j);this.Xd.set(c,g);this.Zc.set(c,e);this.kd.set(c,h);this.jd.set(c,f);a.d=r;G.ga(this.c+".update");this.ed=r}}}};function kg(a,b){var c=b.k.Yc,c=a.o.j.Fa(b.Mb.l.Fa(new L(c[0],c[1],c[2]))),c=Uc(a.o.ja,c);return Math.round(1E3*c)/1E3}
u.$f=function(a,b){if(this.M.PICKING_ENABLED){this.tb(n,r);var c=new Uint8Array(4);this.a.readPixels(a,this.A-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
u.tb=function(a,b){Gf.h.tb.call(this,a,b);var c=this.Ra.r,d=c.length;if(0!=d){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.kf):this.a.bindFramebuffer(this.a.FRAMEBUFFER,q);this.a.viewport(0,0,this.D,this.A);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var e=this.o.jf,f=this.o.zb;this.a.uniformMatrix4fv(this.Dc.get("perspective"),r,e);this.a.uniformMatrix4fv(this.Dc.get("view"),r,f);e=this.i;this.a.uniform3f(this.Dc.get("center"),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));
f=this.pb.length;for(e=0;e<f;++e){var g=this.pb[e];if(g instanceof W){var h=new L(1,0,0),h=this.o.j.Fa(h),j=Uc(this.o.ja,h),h=new L(-1,0,0),h=this.o.j.Fa(h),l=Uc(this.o.ja,h),h=new L(0,1,0),h=this.o.j.Fa(h),m=Uc(this.o.ja,h),h=new L(0,-1,0),h=this.o.j.Fa(h),p=Uc(this.o.ja,h),h=new L(0,0,1),h=this.o.j.Fa(h),t=Uc(this.o.ja,h),h=new L(0,0,-1),h=this.o.j.Fa(h),h=Uc(this.o.ja,h),o=Math.max(j,m,t,l,p,h);o==j||o==l?se(g,0):o==m||o==p?se(g,1):(o==t||o==h)&&se(g,2)}}if(this.M.ORDERING_ENABLED){j=r;f=this.pb;
g=f.length-1;do if(e=f[g],e instanceof W&&e.Ba){l=e.qb;j=e.Ta.e;1==l?j=e.Ua.e:2==l&&(j=e.Va.e);l=j.length;m=j[0];m.N=kg(this,m);m.O=e.O;p=j[l-1];p.N=kg(this,p);p.O=e.O;p=Math.round(1E3*((p.N-m.N)/l))/1E3;for(t=t=1;t<l-1;t++)h=Math.round(1E3*(m.N+t*p))/1E3,j[t].N=h,j[t].O=e.O;j=n}while(g--);f=this.Ra.r;g=f.length-1;do if(e=f[g],e.Aa&&!(1==e.O||e instanceof re))e.N=kg(this,e),j=n;while(g--);j&&this.Ra.sort()}if(f=!a&&x(b)&&b&&this.M.STATISTICS_ENABLED)var w=0,v=0,z=0,A=0;var e=this.Nd,g=e.get("vertexPosition"),
j=e.get("vertexNormal"),l=e.get("vertexColor"),m=e.get("vertexTexturePos"),p=e.get("vertexScalar"),e=this.Dc,t=e.get("usePicking"),h=e.get("useObjectColor"),o=e.get("objectColor"),E=e.get("useScalars"),F=e.get("scalarsReplaceMode"),C=e.get("scalarsMin"),J=e.get("scalarsMax"),M=e.get("scalarsMinColor"),Z=e.get("scalarsMaxColor"),ka=e.get("scalarsMinThreshold"),aa=e.get("scalarsMaxThreshold"),$=e.get("objectOpacity"),ua=e.get("labelmapOpacity"),da=e.get("useTexture"),pa=e.get("useLabelMapTexture"),
Ga=e.get("textureSampler"),zc=e.get("textureSampler2"),ed=e.get("volumeLowerThreshold"),pb=e.get("volumeUpperThreshold"),fd=e.get("volumeScalarMin"),Fb=e.get("volumeScalarMax"),jb=e.get("volumeWindowLow"),Db=e.get("volumeWindowHigh"),Ac=e.get("volumeScalarMinColor"),Aa=e.get("volumeScalarMaxColor"),ib=e.get("volumeTexture"),dd=e.get("objectTransform"),cd=e.get("pointSize"),e=d;do{var Q=c[d-e];if(Q){var R=q;Q instanceof re&&Q.Xa&&(R=Q.Xa);if(Q.Aa&&(!R||R.Aa)){var qa=Q.ta,Ra=Q.tc,Ba=this.Ec.get(qa),
ab=this.Xd.get(qa),Td=this.Zc.get(qa),Eb=this.jd.get(qa),Ud=this.kd.get(qa);this.a.bindBuffer(this.a.ARRAY_BUFFER,Ba.Y);this.a.vertexAttribPointer(g,Ba.hb,this.a.FLOAT,r,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,ab.Y);this.a.vertexAttribPointer(j,ab.hb,this.a.FLOAT,r,0,0);a?this.a.uniform1i(t,n):this.a.uniform1i(t,r);Td&&!a&&!Ra?(this.a.uniform1i(h,r),this.a.bindBuffer(this.a.ARRAY_BUFFER,Td.Y),this.a.vertexAttribPointer(l,Td.hb,this.a.FLOAT,r,0,0)):(ab=1,Ra&&!a&&(ab=0),this.a.uniform1i(h,ab),ab=
Q.wb,a&&(ab=[Math.floor(qa%65025%255)/255,Math.floor(qa%65025/255)/255,Math.floor(qa/65025)/255]),this.a.uniform3f(o,parseFloat(ab[0]),parseFloat(ab[1]),parseFloat(ab[2])),this.a.vertexAttribPointer(l,Ba.hb,this.a.FLOAT,r,0,0));Eb&&!a&&!Ra?(this.a.uniform1i(E,n),this.a.uniform1i(F,Q.q.mf),qa=Q.q.kb,Ra=Q.q.ib,this.a.uniform3f(M,parseFloat(qa[0]),parseFloat(qa[1]),parseFloat(qa[2])),this.a.uniform3f(Z,parseFloat(Ra[0]),parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(ka,parseFloat(Q.q.ba)),this.a.uniform1f(aa,
parseFloat(Q.q.da)),this.a.uniform1f(C,parseFloat(Q.q.Ja)),this.a.uniform1f(J,parseFloat(Q.q.za)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Eb.Y),this.a.vertexAttribPointer(p,Eb.hb,this.a.FLOAT,r,0,0)):(this.a.uniform1i(E,r),this.a.vertexAttribPointer(p,Ba.hb,this.a.FLOAT,r,0,0));this.a.uniform1f($,parseFloat(Q.O));Q.$&&Ud&&!a?(this.a.uniform1i(da,n),this.a.activeTexture(this.a.TEXTURE0),this.a.bindTexture(this.a.TEXTURE_2D,this.ld.get(Q.$.ta)),this.a.uniform1i(Ga,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,
Ud.Y),this.a.vertexAttribPointer(m,Ud.hb,this.a.FLOAT,r,0,0),this.a.uniform1i(ib,r)):(this.a.uniform1i(da,r),this.a.vertexAttribPointer(m,Ba.hb,this.a.FLOAT,r,0,0));R&&(this.a.uniform1i(ib,n),this.a.uniform1f(ed,R.ba),this.a.uniform1f(pb,R.da),this.a.uniform1f(fd,R.Ja),this.a.uniform1f(Fb,R.za),qa=R.kb,Ra=R.ib,this.a.uniform3f(Ac,parseFloat(qa[0]),parseFloat(qa[1]),parseFloat(qa[2])),this.a.uniform3f(Aa,parseFloat(Ra[0]),parseFloat(Ra[1]),parseFloat(Ra[2])),this.a.uniform1f(jb,R.Ob),this.a.uniform1f(Db,
R.Nb),Eb=R.v,this.a.uniform1i(pa,r),R.Ba?this.a.uniform1f($,parseFloat(R.O)):Eb&&Eb.Aa&&(R=Q.v.ta,this.a.uniform1i(pa,n),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.ld.get(R)),this.a.uniform1i(zc,1),this.a.uniform1f(ua,Eb.O)));this.a.uniformMatrix4fv(dd,r,Q.Mb.Pa);R=1;"POINTS"==Q.ka&&(R=Q.Bc);this.a.uniform1f(cd,R);R=-1;Q.ka==rd?(R=this.a.TRIANGLES,f&&(v+=Ba.gb/3)):"LINES"==Q.ka?(this.a.lineWidth(Q.bc),R=this.a.LINES,f&&(z+=Ba.gb/2)):"POINTS"==Q.ka?(R=this.a.POINTS,
f&&(A+=Ba.gb)):"TRIANGLE_STRIPS"==Q.ka?(R=this.a.TRIANGLE_STRIP,f&&(v+=Ba.gb/3)):"POLYGONS"==Q.ka&&(R=0==Ba.gb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(v+=Ba.gb/3));f&&(w+=Ba.gb);this.a.drawArrays(R,0,Ba.gb)}}}while(--e);f&&(c="Objects: "+d+" | "+("Vertices: "+w+" | ")+("Triangles: "+Math.round(v)+" | "),c=c+("Lines: "+z+" | ")+("Points: "+A+" | ")+("Textures: "+this.ld.la()),window.console.log(c))}};
u.ud=function(){this.be=q;delete this.be;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);Gf.h.ud.call(this)};B("X.renderer3D",Gf);B("X.renderer3D.prototype.init",Gf.prototype.aa);B("X.renderer3D.prototype.add",Gf.prototype.add);B("X.renderer3D.prototype.onShowtime",Gf.prototype.Wf);B("X.renderer3D.prototype.onRender",Gf.prototype.Uf);B("X.renderer3D.prototype.get",Gf.prototype.get);B("X.renderer3D.prototype.render",Gf.prototype.Wb);B("X.renderer3D.prototype.destroy",Gf.prototype.ud);
B("X.renderer3D.prototype.resetBoundingBox",Gf.prototype.Ph);B("X.renderer3D.prototype.resetViewAndRender",Gf.prototype.lc);B("X.renderer3D.prototype.pick",Gf.prototype.$f);function Y(){Ff.call(this);this.c="renderer2D";this.cf=this.Qd=this.bf=this.Pd=this.Sa=q;this.ce=this.de=0}D(Y,Ff);Y.prototype.Dh=ba();Y.prototype.Le=function(a){Y.h.Le.call(this,a);var b=this.pb[0];if(b){var c=this.Sa;b["index"+c]=a.C?b["index"+c]+1:b["index"+c]-1;eval("this.onScroll();")}};Y.prototype.__defineGetter__("orientation",s("Sa"));Y.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"X"!=a&&"Y"!=a&&"Z"!=a&&i(Error("Invalid orientation."));this.Sa=a});
Y.prototype.aa=function(){this.Sa||i(Error("No 2D orientation set."));Y.h.aa.call(this,"2d");this.a.fillStyle="rgba(0,0,0,0)";this.a.fillRect(0,0,this.X.width,this.X.height);this.Pd=fe("canvas");this.Qd=fe("canvas")};Y.prototype.lc=function(){Y.h.lc.call(this);lg(this)};
Y.prototype.Oa=function(a){Y.h.Oa.call(this,a);var b=r;this.get(a.ta)&&(b=n);var c=a.t,d=a.v,e=a.Q;if(x(d)&&x(d.t)&&d.t.d)this.Oa(d);else if(x(e)&&x(e.t)&&e.t.d)this.R.load(e,a);else if(x(c)&&c.d)this.R.load(a,a);else{d=c=0;e=a.T;"X"==this.Sa?(this.Kb=a.Ta.e,c=e[2],d=e[1]):"Y"==this.Sa?(this.Kb=a.Ua.e,c=e[0],d=e[2]):"Z"==this.Sa&&(this.Kb=a.Va.e,c=e[0],d=e[1]);"X"==this.Sa&&(e=d,d=c,c=e);this.de=c;this.ce=d;e=this.Pd;e.width=c;e.height=d;var f=this.Qd;f.width=c;f.height=d;this.bf=e.getContext("2d");
this.cf=f.getContext("2d");b||(this.Ra.add(a),lg(this))}};function lg(a){var b=Math.min(a.D/a.de,a.A/a.ce);N(a.o.j,2,3,10*b-10)}
Y.prototype.tb=function(a,b){Y.h.tb.call(this,a,b);if(0!=this.Ra.r.length){var c=this.D,d=this.A,e=this.o.j;this.a.save();this.a.clearRect(-c,-d,2*c,2*d);this.a.restore();var f=1*e.L(0,3),g=-1*e.L(1,3),h=Math.max(1+e.L(2,3)/10,0.6);this.a.setTransform(h,0,0,h,f,g);var e=this.pb[0],j=this.Kb[parseInt(e["index"+this.Sa],10)],l=j.$.nb,j=j.v,m=q;j&&(m=j.nb);var p=this.de,t=this.ce,c=1/(2*h)*(c-p*h)+f,d=1/(2*h)*(d-t*h)+g,g=this.bf,f=this.cf,h=g.getImageData(0,0,p,t),p=f.getImageData(0,0,p,t),t=h.data,
o=p.data,w=t.length,v=e.za,z=e.ba,A=e.da,E=0;do{var F=[0,0,0,0],C=[0,0,0,0],J=l[E]/255*v,M=l[E],Z=e.Ob/v,M=(M/255-Z)/(e.Nb/v-Z),M=255*M;J>=z&&J<=A&&(F=new L(e.kb[0],e.kb[1],e.kb[2]),F=(new L(e.ib[0],e.ib[1],e.ib[2])).scale(M).add(F.scale(255-M)),F=[Math.floor(F.x),Math.floor(F.y),Math.floor(F.b),255],j&&(C=[m[E],m[E+1],m[E+2],m[E+3]]));M=w-1-E;t[M-3]=F[0];t[M-2]=F[1];t[M-1]=F[2];t[M]=F[3];o[M-3]=C[0];o[M-2]=C[1];o[M-1]=C[2];o[M]=C[3];E+=4}while(E<w);g.putImageData(h,0,0);f.putImageData(p,0,0);this.a.globalAlpha=
1;this.a.drawImage(this.Pd,c,d);j&&e.v.Aa&&(this.a.globalAlpha=e.v.O,this.a.drawImage(this.Qd,c,d))}};B("X.renderer2D",Y);B("X.renderer2D.prototype.init",Y.prototype.aa);B("X.renderer2D.prototype.add",Y.prototype.add);B("X.renderer2D.prototype.onShowtime",Y.prototype.Wf);B("X.renderer2D.prototype.onRender",Y.prototype.Uf);B("X.renderer2D.prototype.onScroll",Y.prototype.Dh);B("X.renderer2D.prototype.get",Y.prototype.get);B("X.renderer2D.prototype.resetViewAndRender",Y.prototype.lc);
B("X.renderer2D.prototype.render",Y.prototype.Wb);B("X.renderer2D.prototype.destroy",Y.prototype.ud);function mg(){S.call(this);this.c="fibers";Ca(this,new Qc)}D(mg,S);B("X.fibers",mg);function ng(){S.call(this);this.c="mesh";Ca(this,new Qc)}D(ng,S);B("X.mesh",ng);
